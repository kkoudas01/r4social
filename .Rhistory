geom_col(fill = "steelblue") +
labs(
x = NULL,  # Αφαίρεση ετικετών άξονα x
y = "Συντελεστής Συσχέτισης Spearman"
) +
theme_minimal() +
theme(
axis.text.x = element_blank(),  # Αφαίρεση ετικετών χωρών
axis.ticks.x = element_blank(),  # Αφαίρεση τικ marks
plot.title = element_text(hjust = 0.5)
)
# Μετατροπή σε interactive plot
ggplotly(p, tooltip = "text")
}
happinessCantrilLadder <- read.csv("happinessCantrilLadder.csv", na.string = "")
knitr::kable(head(happinessCantrilLadder)) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
suicides <- read.csv("suicides.csv", na.string = "")
knitr::kable(head(suicides)) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
happinessCantrilLadder2024 <- happinessCantrilLadder[happinessCantrilLadder$Year==2024 & !is.na(happinessCantrilLadder$Code),-1]
happinessCantrilLadder2024wide <- dcast(happinessCantrilLadder2024, Year ~ Code, value.var="Cantril.ladder.score")
happinessCantrilLadder2024wide <- happinessCantrilLadder2024wide[,-1]
dentrogramma(happinessCantrilLadder2024wide)
suicides2024 <- suicides[suicides$Year==2021 & !is.na(suicides$Code),-1]
suicides2024wide <- dcast(suicides2024, Year ~ Code, value.var="Age.standardized.death.rate.from.self.harm.among.both.sexes")
suicides2024wide <- suicides2024wide[,-1]
dentrogramma(suicides2024wide)
happyANDsuicides <-merge(x=happinessCantrilLadder,y=suicides,by=c("Code","Year"))
happyANDsuicides <- happyANDsuicides[!is.na(happyANDsuicides$Code),]
happyANDsuicidesPlot <- ggplot(happyANDsuicides, aes(x = Cantril.ladder.score, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
happyANDsuicidesPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Επίπεδο ευχαρίστησης",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
ggplotly(happyANDsuicidesPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Επίπεδο ευχαρίστησης",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
spearman_data_auto(happyANDsuicides,
"Age.standardized.death.rate.from.self.harm.among.both.sexes",
"Cantril.ladder.score")
gdpPerCapita <- read.csv("gdpPerCapita.csv", na.string = "")
knitr::kable(head(gdpPerCapita)) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
happyANDgdpPerCapita <-merge(x=happinessCantrilLadder,y=gdpPerCapita,by=c("Code","Year"))
happyANDgdpPerCapita <- happyANDgdpPerCapita[!is.na(happyANDgdpPerCapita$Code),]
happyANDgdpPerCapitaPlot <- ggplot(happyANDgdpPerCapita, aes(x = GDP.per.capita, y = Cantril.ladder.score))
happyANDgdpPerCapitaPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
ggplotly(happyANDgdpPerCapitaPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης"   # Αλλάζει την ετικέτα του άξονα Υ
))
suicidesANDgdpPerCapita <-merge(x=suicides,y=gdpPerCapita,by=c("Code","Year"))
suicidesANDgdpPerCapita <- suicidesANDgdpPerCapita[!is.na(suicidesANDgdpPerCapita$Code),]
suicidesANDgdpPerCapitaPlot <- ggplot(suicidesANDgdpPerCapita, aes(x = GDP.per.capita, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
suicidesANDgdpPerCapitaPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
ggplotly(suicidesANDgdpPerCapitaPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
spearman_data_auto(suicidesANDgdpPerCapita,
"Age.standardized.death.rate.from.self.harm.among.both.sexes",
"GDP.per.capita")
suicidesANDgdpPerCapitaB <- suicidesANDgdpPerCapita[suicidesANDgdpPerCapita$GDP.per.capita<=50000,]
suicidesANDgdpPerCapitaPlotB <- ggplot(suicidesANDgdpPerCapitaB, aes(x = GDP.per.capita, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
suicidesANDgdpPerCapitaPlotB + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
suicidesANDgdpPerCapitaB <- suicidesANDgdpPerCapita[suicidesANDgdpPerCapita$GDP.per.capita<=35000,]
suicidesANDgdpPerCapitaPlotB <- ggplot(suicidesANDgdpPerCapitaB, aes(x = GDP.per.capita, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
suicidesANDgdpPerCapitaPlotB + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
ggplotly(suicidesANDgdpPerCapitaPlotB + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
ggplotly(suicidesANDgdpPerCapitaPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
cor(suicidesANDgdpPerCapita$Age.standardized.death.rate.from.self.harm.among.both.sexes,suicidesANDgdpPerCapita$GDP.per.capita, method = "spearman")
cor(suicidesANDgdpPerCapitaB$Age.standardized.death.rate.from.self.harm.among.both.sexes,suicidesANDgdpPerCapitaB$GDP.per.capita, method = "spearman")
suicidesANDgdpPerCapitaB <- suicidesANDgdpPerCapita[suicidesANDgdpPerCapita$Age.standardized.death.rate.from.self.harm.among.both.sexes<=10,]
suicidesANDgdpPerCapitaPlotB <- ggplot(suicidesANDgdpPerCapitaB, aes(x = GDP.per.capita, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
suicidesANDgdpPerCapitaPlotB + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
suicidesANDgdpPerCapitaB <- suicidesANDgdpPerCapita[suicidesANDgdpPerCapita$Age.standardized.death.rate.from.self.harm.among.both.sexes>=10,]
suicidesANDgdpPerCapitaPlotB <- ggplot(suicidesANDgdpPerCapitaB, aes(x = GDP.per.capita, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
suicidesANDgdpPerCapitaPlotB + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
cor(suicidesANDgdpPerCapitaB$Age.standardized.death.rate.from.self.harm.among.both.sexes,suicidesANDgdpPerCapitaB$GDP.per.capita, method = "spearman")
suicidesANDgdpPerCapitaB <- suicidesANDgdpPerCapita[suicidesANDgdpPerCapita$Age.standardized.death.rate.from.self.harm.among.both.sexes>=15,]
suicidesANDgdpPerCapitaPlotB <- ggplot(suicidesANDgdpPerCapitaB, aes(x = GDP.per.capita, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
suicidesANDgdpPerCapitaPlotB + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
ggplotly(suicidesANDgdpPerCapitaPlotB + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
ggplotly(suicidesANDgdpPerCapitaPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
ggplotly(suicidesANDgdpPerCapitaPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
medianIncome <- read.csv("medianIncome.csv", na.string = "")
knitr::kable(head(medianIncome)) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
View(medianIncome)
happyANDmedian <-merge(x=happinessCantrilLadder,y=medianIncome,by=c("Code","Year"))
happyANDmedian <- happyANDmedian[!is.na(happyANDmedian$Code),]
happyANDmedianPlot <- ggplot(happyANDmedian, aes(x = Median..2021.prices....Income.or.consumption.consolidated, y = Cantril.ladder.score))
happyANDmedianPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
cor(happyANDmedian$Cantril.ladder.score,happyANDmedian$Median..2021.prices....Income.or.consumption.consolidated, method = "spearman")
happyANDmedianPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Διάμεσο ημερίσιο εισόδημα",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
ggplotly(happyANDmedianPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
GiniIndex <- read.csv("GiniIndex.csv", na.string = "")
knitr::kable(head(GiniIndex)) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
happyANDgini <-merge(x=happinessCantrilLadder,y=GiniIndex,by=c("Code","Year"))
happyANDgini <- happyANDgini[!is.na(happyANDgini$Code),]
happyANDginiPlot <- ggplot(happyANDgini, aes(x = Gini.coefficient..2021.prices....Income.or.consumption.consolidated, y = Cantril.ladder.score))
happyANDginiPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
cor(happyANDmedian$Cantril.ladder.score,happyANDmedian$Median..2021.prices....Income.or.consumption.consolidated, method = "spearman")
ggplotly(happyANDgdpPerCapitaPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης"   # Αλλάζει την ετικέτα του άξονα Υ
))
cor(happyANDgini$Cantril.ladder.score,happyANDgini$Gini.coefficient..2021.prices....Income.or.consumption.consolidated, method = "spearman")
ggplotly(happyANDginiPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης"   # Αλλάζει την ετικέτα του άξονα Υ
))
suicidesANDmedian <-merge(x=suicides,y=medianIncome,by=c("Code","Year"))
suicidesANDmedian <- suicidesANDmedian[!is.na(suicidesANDmedian$Code),]
suicidesANDmedianPlot <- ggplot(suicidesANDmedian, aes(x = suicidesANDmedian$Median..2021.prices....Income.or.consumption.consolidated, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
suicidesANDmedianPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
ggplotly(suicidesANDmedianPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης"   # Αλλάζει την ετικέτα του άξονα Υ
))
suicidesANDgini <-merge(x=suicides,y=GiniIndex,by=c("Code","Year"))
suicidesANDgini <- suicidesANDgini[!is.na(suicidesANDgini$Code),]
suicidesANDginiPlot <- ggplot(suicidesANDgini, aes(x = Gini.coefficient..2021.prices....Income.or.consumption.consolidated, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
suicidesANDginiPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Gini",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
cor(suicidesANDgini$Age.standardized.death.rate.from.self.harm.among.both.sexes,suicidesANDgini$Gini.coefficient..2021.prices....Income.or.consumption.consolidated, method = "spearman")
ggplotly(suicidesANDginiPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Διάμεσο ημερίσιο εισόδημα",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
# Πακέτα
rm(list = ls())
if(!require(pheatmap)){
install.packages("pheatmap")
library(pheatmap)
}
if(!require(dplyr)){
install.packages("dplyr")
library(dplyr)
}
if(!require(reshape)){
install.packages("reshape")
library(reshape)
}
if(!require(reshape2)){
install.packages("reshape2")
library(reshape2)
}
if(!require(ggplot2)){
install.packages("ggplot2")
library(ggplot2)
}
if(!require(plotly)){
install.packages("plotly")
library(plotly)
}
# Συναρτήσεις
dentrogrammaArxiko <- function(stiles){
stiles <- stiles %>% select_if(~ !any(is.na(.)))
stiles_m <- as.matrix(stiles)
stiles_m.t <- t(stiles_m)
dist.stiles_m <- dist(stiles_m.t, diag = TRUE, upper = TRUE)
dist.stiles_m <- as.matrix(dist.stiles_m)
pheatmap(dist.stiles_m)
}
dentrogramma <- function(stiles){
stiles <- stiles %>% select_if(~ !any(is.na(.)))
stiles_m <- as.matrix(stiles)
stiles_m.t <- t(stiles_m)
dist.stiles_m <- dist(stiles_m.t, diag = TRUE, upper = TRUE)
dist.stiles_m <- as.matrix(dist.stiles_m)
pheatmap(
dist.stiles_m,
fontsize_row = 8,          # Μείωση μεγέθους γραμμών
fontsize_col = 8,          # Μείωση μεγέθους στηλών
angle_col = 90,            # Περιστροφή labels των στηλών
display_numbers = FALSE,   # Απόκρυψη αριθμών για μεγάλους πίνακες
cluster_rows = TRUE,       # Ομαδοποίηση γραμμών
cluster_cols = TRUE,       # Ομαδοποίηση στηλών
)
}
spearman_data_auto <- function(dataframe, suicide_col, gdp_col) {
# Υπολογισμός συντελεστών Spearman ανά χώρα
spearman_data <- dataframe %>%
group_by(Code) %>%
summarise(
spearman_cor = cor(
.data[[suicide_col]],
.data[[gdp_col]],
method = "spearman",
use = "complete.obs"
)
) %>%
filter(!is.na(spearman_cor))  %>%  # Αφαίρεση χωρών με ελλιπή δεδομένα
filter(abs(spearman_cor) >= 0.3)  # Φιλτράρισμα με βάση την απόλυτη τιμή
# Δημιουργία ggplot
p <- ggplot(spearman_data, aes(x = reorder(Code, spearman_cor), y = spearman_cor,
text = paste("Χώρα:", Code, "<br>Συσχέτιση:", round(spearman_cor, 3)))) +
geom_col(fill = "steelblue") +
labs(
x = NULL,  # Αφαίρεση ετικετών άξονα x
y = "Συντελεστής Συσχέτισης Spearman"
) +
theme_minimal() +
theme(
axis.text.x = element_blank(),  # Αφαίρεση ετικετών χωρών
axis.ticks.x = element_blank(),  # Αφαίρεση τικ marks
plot.title = element_text(hjust = 0.5)
)
# Μετατροπή σε interactive plot
ggplotly(p, tooltip = "text")
}
spearman_data_autoNF <- function(dataframe, suicide_col, gdp_col) {
# Υπολογισμός συντελεστών Spearman ανά χώρα
spearman_data <- dataframe %>%
group_by(Code) %>%
summarise(
spearman_cor = cor(
.data[[suicide_col]],
.data[[gdp_col]],
method = "spearman",
use = "complete.obs"
)
) %>%
filter(!is.na(spearman_cor))
# Δημιουργία ggplot
p <- ggplot(spearman_data, aes(x = reorder(Code, spearman_cor), y = spearman_cor,
text = paste("Χώρα:", Code, "<br>Συσχέτιση:", round(spearman_cor, 3)))) +
geom_col(fill = "steelblue") +
labs(
x = NULL,  # Αφαίρεση ετικετών άξονα x
y = "Συντελεστής Συσχέτισης Spearman"
) +
theme_minimal() +
theme(
axis.text.x = element_blank(),  # Αφαίρεση ετικετών χωρών
axis.ticks.x = element_blank(),  # Αφαίρεση τικ marks
plot.title = element_text(hjust = 0.5)
)
# Μετατροπή σε interactive plot
ggplotly(p, tooltip = "text")
}
happinessCantrilLadder <- read.csv("happinessCantrilLadder.csv", na.string = "")
knitr::kable(head(happinessCantrilLadder)) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
suicides <- read.csv("suicides.csv", na.string = "")
knitr::kable(head(suicides)) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
happinessCantrilLadder2024 <- happinessCantrilLadder[happinessCantrilLadder$Year==2024 & !is.na(happinessCantrilLadder$Code),-1]
happinessCantrilLadder2024wide <- dcast(happinessCantrilLadder2024, Year ~ Code, value.var="Cantril.ladder.score")
happinessCantrilLadder2024wide <- happinessCantrilLadder2024wide[,-1]
dentrogramma(happinessCantrilLadder2024wide)
suicides2024 <- suicides[suicides$Year==2021 & !is.na(suicides$Code),-1]
suicides2024wide <- dcast(suicides2024, Year ~ Code, value.var="Age.standardized.death.rate.from.self.harm.among.both.sexes")
suicides2024wide <- suicides2024wide[,-1]
dentrogramma(suicides2024wide)
happyANDsuicides <-merge(x=happinessCantrilLadder,y=suicides,by=c("Code","Year"))
happyANDsuicides <- happyANDsuicides[!is.na(happyANDsuicides$Code),]
happyANDsuicidesPlot <- ggplot(happyANDsuicides, aes(x = Cantril.ladder.score, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
happyANDsuicidesPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Επίπεδο ευχαρίστησης",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
ggplotly(happyANDsuicidesPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Επίπεδο ευχαρίστησης",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
spearman_data_auto(happyANDsuicides,
"Age.standardized.death.rate.from.self.harm.among.both.sexes",
"Cantril.ladder.score")
gdpPerCapita <- read.csv("gdpPerCapita.csv", na.string = "")
knitr::kable(head(gdpPerCapita)) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
happyANDgdpPerCapita <-merge(x=happinessCantrilLadder,y=gdpPerCapita,by=c("Code","Year"))
happyANDgdpPerCapita <- happyANDgdpPerCapita[!is.na(happyANDgdpPerCapita$Code),]
happyANDgdpPerCapitaPlot <- ggplot(happyANDgdpPerCapita, aes(x = GDP.per.capita, y = Cantril.ladder.score))
happyANDgdpPerCapitaPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
ggplotly(happyANDgdpPerCapitaPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης"   # Αλλάζει την ετικέτα του άξονα Υ
))
suicidesANDgdpPerCapita <-merge(x=suicides,y=gdpPerCapita,by=c("Code","Year"))
suicidesANDgdpPerCapita <- suicidesANDgdpPerCapita[!is.na(suicidesANDgdpPerCapita$Code),]
suicidesANDgdpPerCapitaPlot <- ggplot(suicidesANDgdpPerCapita, aes(x = GDP.per.capita, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
suicidesANDgdpPerCapitaPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
ggplotly(suicidesANDgdpPerCapitaPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
spearman_data_auto(suicidesANDgdpPerCapita,
"Age.standardized.death.rate.from.self.harm.among.both.sexes",
"GDP.per.capita")
medianIncome <- read.csv("medianIncome.csv", na.string = "")
knitr::kable(head(medianIncome)) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
happyANDmedian <-merge(x=happinessCantrilLadder,y=medianIncome,by=c("Code","Year"))
happyANDmedian <- happyANDmedian[!is.na(happyANDmedian$Code),]
happyANDmedianPlot <- ggplot(happyANDmedian, aes(x = Median..2021.prices....Income.or.consumption.consolidated, y = Cantril.ladder.score))
happyANDmedianPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Διάμεσο ημερίσιο εισόδημα",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
ggplotly(happyANDmedianPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Διάμεσο ημερίσιο εισόδημα",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
suicidesANDmedian <-merge(x=suicides,y=medianIncome,by=c("Code","Year"))
suicidesANDmedian <- suicidesANDmedian[!is.na(suicidesANDmedian$Code),]
suicidesANDmedianPlot <- ggplot(suicidesANDmedian, aes(x = suicidesANDmedian$Median..2021.prices....Income.or.consumption.consolidated, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
suicidesANDmedianPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Διάμεσο ημερίσιο εισόδημα",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
cor(happyANDmedian$Cantril.ladder.score,happyANDmedian$Median..2021.prices....Income.or.consumption.consolidated, method = "spearman")
ggplotly(suicidesANDmedianPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Διάμεσο ημερίσιο εισόδημα",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
GiniIndex <- read.csv("GiniIndex.csv", na.string = "")
knitr::kable(head(GiniIndex)) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
happyANDgini <-merge(x=happinessCantrilLadder,y=GiniIndex,by=c("Code","Year"))
happyANDgini <- happyANDgini[!is.na(happyANDgini$Code),]
happyANDginiPlot <- ggplot(happyANDgini, aes(x = Gini.coefficient..2021.prices....Income.or.consumption.consolidated, y = Cantril.ladder.score))
happyANDginiPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
cor(happyANDgini$Cantril.ladder.score,happyANDgini$Gini.coefficient..2021.prices....Income.or.consumption.consolidated, method = "spearman")
ggplotly(happyANDginiPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης"   # Αλλάζει την ετικέτα του άξονα Υ
))
suicidesANDgini <-merge(x=suicides,y=GiniIndex,by=c("Code","Year"))
suicidesANDgini <- suicidesANDgini[!is.na(suicidesANDgini$Code),]
suicidesANDginiPlot <- ggplot(suicidesANDgini, aes(x = Gini.coefficient..2021.prices....Income.or.consumption.consolidated, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
suicidesANDginiPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Gini",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
cor(suicidesANDgini$Age.standardized.death.rate.from.self.harm.among.both.sexes,suicidesANDgini$Gini.coefficient..2021.prices....Income.or.consumption.consolidated, method = "spearman")
ggplotly(suicidesANDginiPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Gini",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Αυτοκτονίες ανά 100 000"   # Αλλάζει την ετικέτα του άξονα Υ
))
workingHours2r <- read.csv("workingHours2r.csv", na.string = "")
knitr::kable(head(workingHours2r)) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
happyANDwork <-merge(x=happinessCantrilLadder,y=workingHours2r,by=c("Code","Year"))
happyANDwork <- happyANDwork[!is.na(happyANDwork$Code),]
happyANDworkPlot <- ggplot(happyANDwork, aes(x = Working.hours.per.worker, y = Cantril.ladder.score))
happyANDworkPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Ώρες εργασίας",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
cor(happyANDmedian$Cantril.ladder.score,happyANDmedian$Median..2021.prices....Income.or.consumption.consolidated, method = "spearman")
ggplotly(happyANDworkPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης"   # Αλλάζει την ετικέτα του άξονα Υ
))
suicidesANDwork <-merge(x=suicides,y=workingHours2r,by=c("Code","Year"))
suicidesANDwork <- suicidesANDwork[!is.na(suicidesANDwork$Code),]
suicidesANDworkPlot <- ggplot(suicidesANDwork, aes(x = suicidesANDwork$Working.hours.per.worker, y = Age.standardized.death.rate.from.self.harm.among.both.sexes))
suicidesANDworkPlot + stat_density_2d(geom = "raster", aes(fill = after_stat(density)), contour = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης",   # Αλλάζει την ετικέτα του άξονα Υ
fill = "Πυκνότητα"           # Προαιρετικά: αλλάζει την ετικέτα του legend
)
ggplotly(suicidesANDworkPlot + geom_line(alpha = 3/5, aes(colour = Code), show.legend = FALSE) +
labs(
x = "Κατά κεφαλήν ΑΕΠ",  # Αλλάζει την ετικέτα του άξονα Χ
y = "Επίπεδο ευχαρίστησης"   # Αλλάζει την ετικέτα του άξονα Υ
))
