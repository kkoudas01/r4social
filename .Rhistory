T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",ttt,"))+I(cos(2*pi*t/",ttt,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
# seiraF <- get(seira)
# lm(t ~ seiraF)
seira
listPeriod[2]
tt <- 1:100
dd <- 6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
listPeriod <- c(6,7)
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",t,"))+I(cos(2*pi*t/",t,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
# seiraF <- get(seira)
# lm(t ~ seiraF)
seira
tt <- 1:100
dd <- 6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
listPeriod <- c(6,7)
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
# seiraF <- get(seira)
# lm(t ~ seiraF)
seira
tt <- 1:100
dd <- 6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
listPeriod <- c(6,7)
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
seiraF <- get(seira)
tt <- 1:100
dd <- 6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
listPeriod <- c(6,7)
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
seiraF <- get(seira);
get("ttt")
tt <- 1:100
dd <- 6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
listPeriod <- c(6,7)
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
lm(t ~ get(seira))
tt <- 1:100
dd <- 6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
listPeriod <- c(6,7)
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
lm(t ~ seira)
tt <- 1:100
dd <- 6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
listPeriod <- c(6,7)
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("t ~", seira)
lm_model <- lm(as.formula(formula_string))
tt <- 1:100
dd <- 6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
listPeriod <- c(6,7)
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*tt/",T,"))+I(cos(2*pi*tt/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*tt/",T,"))+I(cos(2*pi*tt/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("tt ~", seira)
lm_model <- lm(as.formula(formula_string))
lm_model
rm(list = ls())
tt <- 1:100
dd <- 6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
tt <- 1:100
dd <- 6*sin( (2*pi/3) * tt)-4*cos( (2*pi/6) * tt)+rnorm(100)
listPeriod <- c(6,7)
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*tt/",T,"))+I(cos(2*pi*tt/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*tt/",T,"))+I(cos(2*pi*tt/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("tt ~", seira)
lm_model <- lm(as.formula(formula_string))
rm(list = ls())
tt <- 1:100
dd <- 6*sin( (2*pi/3) * tt)-4*cos( (2*pi/6) * tt)+rnorm(100)
seiraFourier <- function(t,dedomena, listPeriod){
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("t ~", seira)
lm_model <- lm(as.formula(formula_string))
}
seiraFourier(tt,dd,c(6))
seiraFourier <- function(t,dedomena, listPeriod){
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("t ~", seira)
lm_model <- lm(as.formula(formula_string))
lm_model
}
seiraFourier(tt,dd,c(6))
seiraFourier(tt,dd,c(6,7))
tt <- 1:100
dd <- 6*sin( (2*pi/3) * tt)-4*cos( (2*pi/6) * tt)+rnorm(100)
tt <- 1:100
dd <- 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)+rnorm(100)
seiraFourier <- function(t,dedomena, listPeriod){
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("t ~", seira)
lm_model <- lm(as.formula(formula_string))
lm_model
}
seiraFourier(tt,dd,c(6,7))
tt <- 1:100
dd <- 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)
seiraFourier <- function(t,dedomena, listPeriod){
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("t ~", seira)
lm_model <- lm(as.formula(formula_string))
lm_model
}
seiraFourier(tt,dd,c(6,7))
tt <- 1:1000
dd <- 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)
seiraFourier(tt,dd,c(6,7))
plot(tt,dd)
tt <- 1:100
dd <- 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)
plot(tt,dd)
seiraFourier(dd,tt,c(6,7))
tt <- 1:1000
dd <- 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)
seiraFourier(dd,tt,c(6,7))
tt <- (1:1000)100
tt <- (1:1000)/100
dd <- 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)
seiraFourier(dd,tt,c(6,7))
plot(tt,dd)
tt <- (1:1000)/10
dd <- 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)
plot(tt,dd)
seiraFourier(dd,tt,c(6,7))
seiraFourier <- function(dedomena,t, listPeriod){
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("t ~", seira)
lm_model <- lm(as.formula(formula_string))
lm_model
}
tt <- (1:1000)/10
dd <- 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)
seiraFourier(dd,tt,c(6,7))
seiraFourier <- function(t,dedomena, listPeriod){
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("t ~", seira)
lm_model <- lm(as.formula(formula_string))
lm_model
}
seiraFourier <- function(t,dedomena, listPeriod){
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("dedomena ~", seira)
lm_model <- lm(as.formula(formula_string))
lm_model
}
tt <- (1:1000)/10
dd <- 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)
seiraFourier(tt,dd,c(6,7))
tt <- (1:1000)/10
dd <- 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)+rnorm(1000)
seiraFourier(tt,dd,c(6,7))
plot(tt,dd)
seiraFourier(tt,dd,c(6))
seiraFourier(tt,dd,c(6,7))
tt <- (1:1000)/10
dd <- 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)+rnorm(1000)
seiraFourier(tt,dd,c(6,7))
rmarkdown::render_site()
tt <- (1:1000)/10
dd <- 75+ 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)+100*6*sin( (2*pi/7) * tt)+rnorm(1000)
tt <- (1:1000)/10
dd <- 75+ 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)+100*6*sin( (2*pi/7) * tt)+rnorm(1000)
seiraFourier <- function(t,dedomena, listPeriod){
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("dedomena ~", seira)
lm_model <- lm(as.formula(formula_string))
lm_model
}
seiraFourier(tt,dd,c(6,7))
tt <- (1:1000)/10
dd <- 75+ 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)+100*sin( (2*pi/7) * tt)+rnorm(1000)
seiraFourier(tt,dd,c(6,7))
rmarkdown::render_site()
massExttsComp <- decompose(massExtts)
massExtts <- ts(massExtDF$mass.extinction...United.States., start = c(2004, 1), freq=12)
gamoiSynolots <- ts(gamoi$GamoiSynolo, start = 0, freq=4)
yTs <- ts(y, start = 0, frequency = 6)
massExttsComp <- decompose(massExtts)
rm(list = ls())
massExtDF <- read.csv("massExt.csv")
knitr::kable(massExtDF) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
if(!require(readxl)){
install.packages("readxl")
library(readxl)
}
gamoi <- readxl::read_excel("gamoi.xlsx")
knitr::kable(gamoi) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
massExt <- massExtDF$mass.extinction...United.States.
gamoiSynolo <- gamoi$GamoiSynolo
x <- 1:100
y <- x+6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
plot(massExt, type ="l")
plot(gamoiSynolo, type ="l")
plot(y, type ="l")
if(!require(forecast)){
install.packages("forecast")
library(forecast)
}
gglagplot(gamoiSynolo, continuous = TRUE, set.lags = 2*(1:10))
gglagplot(y, continuous = TRUE, set.lags = 2*(1:10))
acf(massExt)
acf(gamoiSynolo)
if(!require(lomb)){
install.packages("lomb")
library(lomb)
}
lsp(massExt)
lsp(massExt,type = "period")
lsp(massExt, from = 5, to = 25, type = "period")
lsp(massExt, from = 5, to = 25, type = "period", alpha = 0.05)
lsp(massExt, from = 5, to = 25, type = "period",
ofac = 100, alpha = 0.05)
lsp(gamoiSynolo)
prosdiorismosPerSyxn <- function(dedomena, apo = NULL, eos = NULL){
periodogramma <- lsp(dedomena, times = NULL, from = apo, to = eos, type = "period",
ofac = 130, alpha = 0.01, normalize="press", plot = FALSE)
per <- periodogramma$peak.at[1]
syxn <- periodogramma$peak.at[2]
Period <- c(per)
Frequency <- c(syxn)
data.frame(Period,Frequency)
}
prosdiorismosPerSyxn(massExt, 4, 15)
prosdiorismosPerSyxn(massExt, 4, 10)
prosdiorismosPerSyxn(massExt, 10, 15)
prosdiorismosPerSyxn(gamoiSynolo, 3, 10)
massExtts <- ts(massExtDF$mass.extinction...United.States., start = c(2004, 1), freq=12)
gamoiSynolots <- ts(gamoi$GamoiSynolo, start = 0, freq=4)
yTs <- ts(y, start = 0, frequency = 6)
plot(massExtts)
plot(gamoiSynolots)
if(!require(seastests)){
install.packages("seastests")
library(seastests)
}
isSeasonal(massExtts)
isSeasonal(gamoiSynolots)
isSeasonal(yTs)
if(!require(ptest)){
install.packages("ptest")
library(ptest)
}
ptestg(massExt)
ptestg(gamoiSynolots)
ptestg(yTs)
ptestg(massExt, method = c("Fisher", "robust", "extended", "extendedRobust",
"FisherRSR"), multiple = FALSE)
ptestg(massExt,method="Fisher")
ptestg(gamoiSynolots,method="Fisher")
# ptestg(massExt,method="robust")
# ptestg(massExt,method="extended")
# ptestg(massExt,method="extendedRobust")
# ptestg(massExt,method="FisherRSR")
massExttsComp <- decompose(massExtts)
massExttsComp <- decompose(massExtts)
print(massExtts)
yTsComp <- decompose(yTs)
gamoiSynolotsComp <- decompose(gamoiSynolots)
sessionInfo()
if(!require(igraph)){
install.packages("igraph")
library(igraph)
}
massExttsComp <- decompose(massExtts)
.rs.restartR()
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
rm(list = ls())
massExtDF <- read.csv("massExt.csv")
knitr::kable(massExtDF) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
if(!require(readxl)){
install.packages("readxl")
library(readxl)
}
gamoi <- readxl::read_excel("gamoi.xlsx")
knitr::kable(gamoi) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
massExt <- massExtDF$mass.extinction...United.States.
gamoiSynolo <- gamoi$GamoiSynolo
x <- 1:100
y <- x+6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
plot(massExt, type ="l")
plot(gamoiSynolo, type ="l")
plot(y, type ="l")
if(!require(forecast)){
install.packages("forecast")
library(forecast)
}
gglagplot(massExt, continuous = TRUE, set.lags = 2*(1:10))
gglagplot(gamoiSynolo, continuous = TRUE, set.lags = 2*(1:10))
gglagplot(y, continuous = TRUE, set.lags = 2*(1:10))
acf(massExt)
acf(gamoiSynolo)
if(!require(lomb)){
install.packages("lomb")
library(lomb)
}
lsp(massExt)
lsp(massExt,type = "period")
lsp(massExt, from = 5, to = 25, type = "period")
lsp(massExt, from = 5, to = 25, type = "period", alpha = 0.05)
lsp(massExt, from = 5, to = 25, type = "period",
ofac = 100, alpha = 0.05)
lsp(gamoiSynolo)
prosdiorismosPerSyxn <- function(dedomena, apo = NULL, eos = NULL){
periodogramma <- lsp(dedomena, times = NULL, from = apo, to = eos, type = "period",
ofac = 130, alpha = 0.01, normalize="press", plot = FALSE)
per <- periodogramma$peak.at[1]
syxn <- periodogramma$peak.at[2]
Period <- c(per)
Frequency <- c(syxn)
data.frame(Period,Frequency)
}
prosdiorismosPerSyxn(massExt, 4, 15)
prosdiorismosPerSyxn(massExt, 4, 10)
prosdiorismosPerSyxn(massExt, 10, 15)
prosdiorismosPerSyxn(gamoiSynolo, 3, 10)
massExtts <- ts(massExtDF$mass.extinction...United.States., start = c(2004, 1), freq=12)
gamoiSynolots <- ts(gamoi$GamoiSynolo, start = 0, freq=4)
yTs <- ts(y, start = 0, frequency = 6)
plot(massExtts)
plot(gamoiSynolots)
if(!require(seastests)){
install.packages("seastests")
library(seastests)
}
isSeasonal(massExtts)
isSeasonal(gamoiSynolots)
isSeasonal(yTs)
if(!require(ptest)){
install.packages("ptest")
library(ptest)
}
ptestg(massExt)
ptestg(gamoiSynolots)
ptestg(yTs)
ptestg(massExt, method = c("Fisher", "robust", "extended", "extendedRobust",
"FisherRSR"), multiple = FALSE)
ptestg(massExt,method="Fisher")
ptestg(gamoiSynolots,method="Fisher")
# ptestg(massExt,method="robust")
# ptestg(massExt,method="extended")
# ptestg(massExt,method="extendedRobust")
# ptestg(massExt,method="FisherRSR")
if(!require(igraph)){
install.packages("igraph")
library(igraph)
}
massExttsComp <- decompose(massExtts)
