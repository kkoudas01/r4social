ptestg(gamoiSynolots,method="Fisher")
# ptestg(massExt,method="robust")
# ptestg(massExt,method="extended")
# ptestg(massExt,method="extendedRobust")
# ptestg(massExt,method="FisherRSR")
massExttsComp <- stl(massExtts, s.window = "periodic")
plot(massExttsComp)
yTsComp <- stl(yTs, s.window = "periodic")
plot(yTsComp)
gamoiSynolotsComp <- stl(gamoiSynolots, s.window = "periodic")
#gamoiSynolotsComp <- decompose(gamoiSynolots)
plot(gamoiSynolotsComp)
seiraFourier <- function(t,dedomena, listPeriod){
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("dedomena ~", seira)
lm_model <- lm(as.formula(formula_string))
lm_model
}
tt <- (1:1000)/10
dd <- 75+ 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)+100*sin( (2*pi/7) * tt)+2*cos( (2*pi/3) * tt)+rnorm(1000)
seiraFourier(tt,dd,c(6,7,3))
plot(tt,dd)
massExttsComp2 <- stl(massExt, s.window = "periodic")
massExtts <- ts(massExtDF$mass.extinction...United.States., start = c(2004, 1), freq=12)
gamoiSynolots <- ts(gamoi$GamoiSynolo, start = 0, freq=4)
gamoiSynolots2 <- ts(gamoi$GamoiSynolo, start = 0, freq=4)
yTs <- ts(y, start = 0, frequency = 6)
gamoiSynolotsComp2 <- stl(gamoiSynolots2, s.window = "periodic")
#gamoiSynolotsComp <- decompose(gamoiSynolots)
plot(gamoiSynolotsComp2)
massExtts <- ts(massExtDF$mass.extinction...United.States., start = c(2004, 1), freq=12)
gamoiSynolots <- ts(gamoi$GamoiSynolo, start = 0, freq=4)
gamoiSynolots2 <- ts(gamoi$GamoiSynolo, start = 0, freq=1)
yTs <- ts(y, start = 0, frequency = 6)
gamoiSynolotsComp2 <- stl(gamoiSynolots2, s.window = "periodic")
rmarkdown::render_site()
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
lsp(massExt)
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
rm(list = ls())
massExtDF <- read.csv("massExt.csv")
knitr::kable(massExtDF) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
if(!require(readxl)){
install.packages("readxl")
library(readxl)
}
gamoi <- readxl::read_excel("gamoi.xlsx")
knitr::kable(gamoi) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
massExt <- massExtDF$mass.extinction...United.States.
gamoiSynolo <- gamoi$GamoiSynolo
x <- 1:100
y <- x+6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
plot(massExt, type ="l")
plot(gamoiSynolo, type ="l")
plot(y, type ="l")
if(!require(forecast)){
install.packages("forecast")
library(forecast)
}
gglagplot(massExt, continuous = TRUE, set.lags = 2*(1:10))
gglagplot(gamoiSynolo, continuous = TRUE, set.lags = 2*(1:10))
gglagplot(y, continuous = TRUE, set.lags = 2*(1:10))
acf(massExt)
acf(gamoiSynolo)
if(!require(lomb)){
install.packages("lomb")
library(lomb)
}
lsp(massExt)
lsp(y)
lsp(massExt,type = "period")
lsp(massExt, from = 5, to = 25, type = "period")
lsp(massExt, from = 5, to = 25, type = "period", alpha = 0.05)
lsp(massExt, from = 5, to = 25, type = "period",
ofac = 100, alpha = 0.05)
lsp(gamoiSynolo)
prosdiorismosPerSyxn <- function(dedomena, apo = NULL, eos = NULL){
periodogramma <- lsp(dedomena, times = NULL, from = apo, to = eos, type = "period",
ofac = 130, alpha = 0.01, normalize="press", plot = FALSE)
per <- periodogramma$peak.at[1]
syxn <- periodogramma$peak.at[2]
Period <- c(per)
Frequency <- c(syxn)
data.frame(Period,Frequency)
}
prosdiorismosPerSyxn(massExt, 4, 15)
prosdiorismosPerSyxn(massExt, 4, 10)
prosdiorismosPerSyxn(massExt, 10, 15)
prosdiorismosPerSyxn(gamoiSynolo, 3, 10)
massExtts <- ts(massExtDF$mass.extinction...United.States., start = c(2004, 1), freq=12)
gamoiSynolots <- ts(gamoi$GamoiSynolo, start = 0, freq=4)
yTs <- ts(y, start = 0, frequency = 6)
plot(massExtts)
plot(gamoiSynolots)
if(!require(seastests)){
install.packages("seastests")
library(seastests)
}
isSeasonal(massExtts)
isSeasonal(gamoiSynolots)
isSeasonal(yTs)
if(!require(ptest)){
install.packages("ptest")
library(ptest)
}
ptestg(massExt)
ptestg(gamoiSynolots)
ptestg(yTs)
ptestg(massExt, method = c("Fisher", "robust", "extended", "extendedRobust",
"FisherRSR"), multiple = FALSE)
ptestg(massExt,method="Fisher")
ptestg(gamoiSynolots,method="Fisher")
# ptestg(massExt,method="robust")
# ptestg(massExt,method="extended")
# ptestg(massExt,method="extendedRobust")
# ptestg(massExt,method="FisherRSR")
massExttsComp <- stl(massExtts, s.window = "periodic")
plot(massExttsComp)
yTsComp <- stl(yTs, s.window = "periodic")
plot(yTsComp)
gamoiSynolotsComp <- stl(gamoiSynolots, s.window = "periodic")
#gamoiSynolotsComp <- decompose(gamoiSynolots)
plot(gamoiSynolotsComp)
seiraFourier <- function(t,dedomena, listPeriod){
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("dedomena ~", seira)
lm_model <- lm(as.formula(formula_string))
lm_model
}
tt <- (1:1000)/10
dd <- 75+ 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)+100*sin( (2*pi/7) * tt)+2*cos( (2*pi/3) * tt)+rnorm(1000)
seiraFourier(tt,dd,c(6,7,3))
plot(tt,dd)
lsp(massExt,type = "period")
lsp(y,type = "period")
lsp(massExt,type = "period")
gamoiSynolotsComp <- stl(gamoiSynolots, s.window = "periodic")
#gamoiSynolotsComp <- decompose(gamoiSynolots)
plot(gamoiSynolotsComp$time.series)
SeasonalMassExt <- seasonal(massExttsComp)
TrendMassExt <- trendcycle(massExttsComp)
RemainderMassExt <- remainder(massExttsComp)
SeasonalMassExt <- seasonal(massExttsComp)
TrendMassExt <- trendcycle(massExttsComp)
RemainderMassExt <- remainder(massExttsComp)
plot(SeasonalMassExt)
SeasonalMassExt <- seasonal(massExttsComp)
TrendMassExt <- trendcycle(massExttsComp)
RemainderMassExt <- remainder(massExttsComp)
plot(RemainderMassExt)
n <- lenght(SeasonalMassExt)
n <- length(SeasonalMassExt)
seiraFourier(1:n,SeasonalMassExt,c(6,7,3))
plot(SeasonalMassExt)
n <- length(SeasonalMassExt)
seiraFourier(1:n,SeasonalMassExt,c(6,12))
plot(SeasonalMassExt)
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
rm(list = ls())
massExtDF <- read.csv("massExt.csv")
knitr::kable(massExtDF) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
if(!require(readxl)){
install.packages("readxl")
library(readxl)
}
gamoi <- readxl::read_excel("gamoi.xlsx")
knitr::kable(gamoi) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
massExt <- massExtDF$mass.extinction...United.States.
gamoiSynolo <- gamoi$GamoiSynolo
x <- 1:100
y <- x+6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
plot(massExt, type ="l")
plot(gamoiSynolo, type ="l")
plot(y, type ="l")
if(!require(forecast)){
install.packages("forecast")
library(forecast)
}
gglagplot(massExt, continuous = TRUE, set.lags = 2*(1:10))
gglagplot(gamoiSynolo, continuous = TRUE, set.lags = 2*(1:10))
gglagplot(y, continuous = TRUE, set.lags = 2*(1:10))
acf(massExt)
acf(gamoiSynolo)
if(!require(lomb)){
install.packages("lomb")
library(lomb)
}
lsp(massExt)
lsp(massExt)
lsp(massExt,type = "period")
lsp(massExt, from = 5, to = 25, type = "period")
lsp(massExt, from = 5, to = 25, type = "period", alpha = 0.05)
lsp(massExt, from = 5, to = 25, type = "period",
ofac = 100, alpha = 0.05)
lsp(gamoiSynolo)
tt <- (1:1000)/10
dd <- 75+ 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)+100*sin( (2*pi/7) * tt)+20*cos( (2*pi/3) * tt)+rnorm(1000)
lsp(dd,type = "period")
lsp(dd,type = "period", from=1, to=10)
lsp(dd,type = "period", from=2, to=10)
lsp(dd,type = "period")
lsp(dd,type = "period", from=2, to=100)
tt <- (1:1000)/10
dd <- 75+ 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)+100*sin( (2*pi/7) * tt)+2*cos( (2*pi/3) * tt)+rnorm(1000)
lsp(dd,type = "period", from=2, to=100)
plot(tt,dd)
Fs <- function(tt){
75+ 6*sin( (2*pi/7) * tt)-4*cos( (2*pi/6) * tt)+100*sin( (2*pi/7) * tt)+2*cos( (2*pi/3) * tt)
}
?curve
plot(tt,dd)
curve(Fs, from=0,t=0)
plot(tt,dd)
curve(Fs, from=0,to=0)
plot(tt,dd)
curve(Fs, from=0,to=10)
plot(tt,dd)
curve(Fs, from=0,to=50)
Fs <- function(tt){
75+ 6*sin( (2*pi/6) * tt)-4*cos( (2*pi/6) * tt)+100*sin( (2*pi/7) * tt)+2*cos( (2*pi/3) * tt)
}
plot(tt,dd)
curve(Fs, from=0,to=50)
Fs <- function(tt){
6*sin( (2*pi/6) * tt)-4*cos( (2*pi/6) * tt)+100*sin( (2*pi/7) * tt)+2*cos( (2*pi/3) * tt)
}
plot(tt,dd)
curve(Fs, from=0,to=50)
tt <- (1:1000)/10
Fs <- function(tt){
10+ 6*sin( (2*pi/6) * tt)-4*cos( (2*pi/6) * tt)+100*sin( (2*pi/7) * tt)+2*cos( (2*pi/3) * tt)
}
dd <- Fs(tt)
seiraFourier(tt,dd,c(6,7,3))
seiraFourier <- function(t,dedomena, listPeriod){
n <- length(listPeriod)
T <- listPeriod[1]
seira <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
if (n>1) {
for (i in 2:n) {
T <- listPeriod[i]
orosN <- paste(c("I(sin(2*pi*t/",T,"))+I(cos(2*pi*t/",T,"))"), collapse="")
seira <- paste(c(seira,orosN), collapse="+")
}
}
formula_string <- paste("dedomena ~", seira)
lm_model <- lm(as.formula(formula_string))
lm_model
}
tt <- (1:1000)/10
Fs <- function(tt){
10+ 6*sin( (2*pi/6) * tt)-4*cos( (2*pi/6) * tt)+100*sin( (2*pi/7) * tt)+2*cos( (2*pi/3) * tt)
}
dd <- Fs(tt)
seiraFourier(tt,dd,c(6,7,3))
plot(tt,dd)
curve(Fs, from=0,to=50)
acf(dd)
?acf
plot(tt,dd)
curve(Fs, from=0,to=50)
acf(dd,lag.max =50)
tt <- (1:1000)/100
Fs <- function(tt){
10+ 6*sin( (2*pi/6) * tt)-4*cos( (2*pi/6) * tt)+100*sin( (2*pi/7) * tt)+2*cos( (2*pi/3) * tt)
}
dd <- Fs(tt)
plot(tt,dd)
curve(Fs, from=0,to=50)
acf(dd,lag.max =50)
lsp(dd,type = "period", from=2, to=100)
lsp(dd,type = "period")
lsp(dd,type = "period", from=2, to=10)
lsp(dd,type = "period", from=20, to=50)
tt <- (1:1000)/100
Fs <- function(tt){
10+ 6*sin( (2*pi/6) * tt)
}
dd <- Fs(tt)
seiraFourier(tt,dd,c(6,7,3))
plot(tt,dd)
curve(Fs, from=0,to=50)
acf(dd,lag.max =50)
lsp(dd,type = "period", from=20, to=50)
lsp(dd,type = "period")
tt <- (1:100)/100
Fs <- function(tt){
10+ 6*sin( (2*pi/6) * tt)
}
dd <- Fs(tt)
seiraFourier(tt,dd,c(6,7,3))
plot(tt,dd)
curve(Fs, from=0,to=50)
acf(dd,lag.max =50)
lsp(dd,type = "period")
tt <- (1:100)
Fs <- function(tt){
10+ 6*sin( (2*pi/6) * tt)
}
dd <- Fs(tt)
seiraFourier(tt,dd,c(6,7,3))
plot(tt,dd)
curve(Fs, from=0,to=50)
acf(dd,lag.max =50)
tt <- (1:100)
Fs <- function(tt){
10+ 6*sin( (2*pi/6) * tt)-4*cos( (2*pi/6) * tt)+100*sin( (2*pi/7) * tt)+2*cos( (2*pi/3) * tt)
}
dd <- Fs(tt)
plot(tt,dd)
curve(Fs, from=0,to=50)
acf(dd,lag.max =50)
lsp(dd,type = "period")
lsp(dd,type = "period",from=0,to=10)
lsp(dd,type = "period",from=0,to=10)
?lsp
lsp(dd,type = "period", from=0, to=10)
lsp(dd,type = "period", from=0, to=100)
lsp(dd,type = "period", from=0, to=10)
lsp(dd,type = "period")
lsp(dd, from = 1, to = 10, type = "period")
lsp(dd, from = 5, to = 7, type = "period")
lsp(dd, from = 5, to = 10, type = "period")
plot(tt,dd)
curve(Fs, from=0,to=50)
acf(dd)
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
rm(list = ls())
massExtDF <- read.csv("massExt.csv")
knitr::kable(massExtDF) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
if(!require(readxl)){
install.packages("readxl")
library(readxl)
}
gamoi <- readxl::read_excel("gamoi.xlsx")
knitr::kable(gamoi) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
massExt <- massExtDF$mass.extinction...United.States.
gamoiSynolo <- gamoi$GamoiSynolo
x <- 1:100
y <- x+6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
plot(massExt, type ="l")
plot(gamoiSynolo, type ="l")
plot(y, type ="l")
if(!require(forecast)){
install.packages("forecast")
library(forecast)
}
gglagplot(massExt, continuous = TRUE, set.lags = 2*(1:10))
gglagplot(gamoiSynolo, continuous = TRUE, set.lags = 2*(1:10))
gglagplot(y, continuous = TRUE, set.lags = 2*(1:10))
acf(massExt)
acf(gamoiSynolo)
acf(y)
acf(y)
pacf(y)
acf(y)
massExtts <- ts(massExtDF$mass.extinction...United.States., start = c(2004, 1), freq=12)
gamoiSynolots <- ts(gamoi$GamoiSynolo, start = 0, freq=4)
massExtts <- ts(massExtDF$mass.extinction...United.States., start = c(2004, 1), freq=12)
gamoiSynolots <- ts(gamoi$GamoiSynolo, start = 0, freq=4)
yTs <- ts(y, start = 0, frequency = 6)
if(!require(seastests)){
install.packages("seastests")
library(seastests)
}
if(!require(seastests)){
install.packages("seastests")
library(seastests)
}
isSeasonal(massExtts)
isSeasonal(massExtts)
isSeasonal(rnorm(100))
isSeasonal(massExtts)
isSeasonal(rnorm(100), freq= 2)
isSeasonal(massExtts)
isSeasonal(massExt, freq=12)
isSeasonal(massExtts)
isSeasonal(massExt, freq=4)
isSeasonal(massExt, freq=12)
isSeasonal(gamoiSynolo, freq=4)
isSeasonal(gamoiSynolots)
isSeasonal(y, freq=6)
isSeasonal(yTs)
isSeasonal(y, freq=3)
isSeasonal(y, freq=7)
if(!require(ptest)){
install.packages("ptest")
library(ptest)
}
if(!require(ptest)){
install.packages("ptest")
library(ptest)
}
ptestg(massExt)
ptestg(gamoiSynolots)
ptestg(yTs)
?ptestg
tt <- (1:100)
Fs <- function(tt){
10+ 6*sin( (2*pi/6) * tt)-4*cos( (2*pi/6) * tt)+100*sin( (2*pi/7) * tt)+2*cos( (2*pi/3) * tt)
}
dd <- Fs(tt)
if(!require(ptest)){
install.packages("ptest")
library(ptest)
}
seiraFourier(tt,dd,c(6,7,3))
ptestg(dd)
1/0.14
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
rm(list = ls())
massExtDF <- read.csv("massExt.csv")
knitr::kable(massExtDF) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
if(!require(readxl)){
install.packages("readxl")
library(readxl)
}
gamoi <- readxl::read_excel("gamoi.xlsx")
knitr::kable(gamoi) %>%
kable_styling("striped", full_width = F) %>%
scroll_box(width = "max-content", height = "200px")
massExt <- massExtDF$mass.extinction...United.States.
gamoiSynolo <- gamoi$GamoiSynolo
x <- 1:100
y <- x+6*sin( (2*pi/3) * x)-4*cos( (2*pi/6) * x)+rnorm(100)
plot(massExt, type ="l")
plot(gamoiSynolo, type ="l")
plot(y, type ="l")
if(!require(forecast)){
install.packages("forecast")
library(forecast)
}
gglagplot(massExt, continuous = TRUE, set.lags = 2*(1:10))
gglagplot(gamoiSynolo, continuous = TRUE, set.lags = 2*(1:10))
gglagplot(y, continuous = TRUE, set.lags = 2*(1:10))
gglagplot(y, continuous = TRUE, set.lags = 2*(1:10))
acf(massExt)
acf(gamoiSynolo)
acf(y)
massExtts <- ts(massExtDF$mass.extinction...United.States., start = c(2004, 1), freq=12)
gamoiSynolots <- ts(gamoi$GamoiSynolo, start = 0, freq=4)
yTs <- ts(y, start = 0, frequency = 6)
if(!require(seastests)){
install.packages("seastests")
library(seastests)
}
if(!require(seastests)){
install.packages("seastests")
library(seastests)
}
isSeasonal(massExt, freq=12)
isSeasonal(massExtts)
isSeasonal(gamoiSynolo, freq=4)
isSeasonal(gamoiSynolots)
isSeasonal(y, freq=6)
isSeasonal(yTs)
isSeasonal(y, freq=7)
massExttsComp <- stl(massExtts, s.window = "periodic")
plot(massExttsComp)
?stl
SeasonalMassExt <- seasonal(massExttsComp)
plot(SeasonalMassExt)
TrendMassExt <- trendcycle(massExttsComp)
plot(TrendMassExt)
RemainderMassExt <- remainder(massExttsComp)
plot(RemainderMassExt)
gamoiSynolotsComp <- stl(gamoiSynolots, s.window = "periodic")
plot(gamoiSynolotsComp)
yTsComp <- stl(yTs, s.window = "periodic")
plot(yTsComp)
if(!require(lomb)){
install.packages("lomb")
library(lomb)
}
lsp(massExt)
