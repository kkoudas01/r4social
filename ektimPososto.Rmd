---
title: "Εκτίμηση ποσοστού"
author: "Κώστας Κούδας"
cache: TRUE
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    fig_caption: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
```

# Επίπεδο εμπιστοσύνης

Σε μία δημοσκόπηση, λοιπόν, στην ομάδα [Μαθηματικό Εργαστήρι](https://www.facebook.com/groups/119060981470596) του facebook [ρωτήθηκαν](https://www.facebook.com/groups/119060981470596/permalink/2811760268867307/) τα μέλη της αν θεωρούν ισοδύναμες τις εξισώσεις:

$2x+\tan(x)=6+\tan(x)$ και $2x=6$.

Κλήθηκαν λοιπόν να διαλέξουν ανάμεσα στις επιλογές:

-   Δεν είναι ισοδύναμες, διότι αν εκληφθούν ως προτασιακοί τύποι, δεν έχουν το ίδιο σύνολο ορισμού.

-   Είναι ισοδύναμες, διότι έχουν τις ίδιες ακριβώς λύσεις.

Την πρώτη επιλογή (δεν είναι ισοδύναμες) υποστήριξαν 56 συνάδερφοι, ενώ την δεύτερη (είναι ισοδύναμες) 48. Από αυτά υπολογίζουμε ότι η αναλογία του «δεν είναι ισοδύναμες» στο δείγμα μας ήταν:

$$\dfrac{56}{56+48}=0.5384615.$$

Ζητάμε να βρούμε πόσο σίγουροι μπορούμε να είμαστε ότι η αναλογία αυτής της άποψης στο σύνολο των μαθηματικών της χώρας δεν θα αποκλίνει από αυτή που βρήκαμε περισσότερο από π.χ. 2 ποσοστιαίες μονάδες (0.02). Αρχικά, βέβαια, διαγράφουμε τα προηγούμενα.

```{r}
rm(list = ls())
```

Γι’ αυτό το σκοπό θα φτιάξουμε μια συνάρτηση που κάνει αυτή τη δουλειά. Η συνάρτηση αυτή θα ονοματιστεί:
`EpipEmpistPos(🍺🍺🍺, 👨👨👨, 🚂🚂🚂)`.

-   Στη θέση του `🍺🍺🍺` γράφουμε το ποσοστό που βρήκαμε (δηλαδή το 0.5384615),

-   στη θέση του `👨👨👨` γράφουμε το πλήθος των τιμών (των συμμετεχόντων μαθηματικών, δηλαδή 56+48=104) και

-   στη θέση του `🚂🚂🚂` γράφουμε την απόσταση που θέλουμε να δούμε αν απέχει η πληθυσμιακή μέση τιμή από τη δειγματική (εδώ αυτή, όπως είπαμε, θέλουμε να είναι 2%=0,02).

Έχουμε λοιπόν:

```{r}
EpipEmpistPos <- function(pososto, plithos, apost) {
  s <- sqrt(pososto*(1-pososto)/plithos)
  2*pt(apost/s,plithos-1)-1
}
```

Οπότε γράφοντας:

```{r}
EpipEmpistPos(0.5384615, 104, 0.02)
```

εξάγεται η απάντηση `r EpipEmpistPos(0.5384615, 104, 0.02)`. Αυτό σημαίνει ότι μπορούμε να είμαστε 31.67% σίγουροι ότι η πραγματική αναλογία είναι μεταξύ των αριθμών:

0.5384615-0.02 και 0.5384615+0.02,

δηλαδή ανάμεσα στα ποσοστά:

51.84% και 55.84%.

Συνολικά, ο κώδικάς μας ήταν ο παρακάτω:

```{r, eval=F}
rm(list = ls())
EpipEmpistPos <- function(pososto, plithos, apost) {
  s <- sqrt(pososto*(1-pososto)/plithos)
  2*pt(apost/s,plithos-1)-1
}
EpipEmpistPos(0.5384615, 104, 0.02)
```


# Διάστημα εμπιστοσύνης

Στην έρευνα [Estimating the Population Size of Female Sex Workerεκπορνευόμενων Tehran, Iran: Application of Directεπιλέχθηκανcapture Method](https://link.springer.com/article/10.1007/s10461-017-1803-9) γίνεται απόπειρα να εκτιμηθεί ο συνολικός αριθμός εκπορνευομένων γυναικών στην Τεχεράνη. Προς τούτο επιλέχθηκαν αρχικά τυχαία 247 ιερόδουλες, στις οποίες δόθηκαν κοντομάνικα μπλουζάκια, αφού τους έγινε ενημέρωση για την έρευνα που διεξάγεται. Για να βρεθεί ο συνολικός αριθμός των ιερόδουλων, αρκεί να βρούμε τι μέρος τους έχει λάβει μπλουζάκι. Αν π.χ. βρούμε ότι το 50% έχει πάρει μπλουζάκι, τότε οι ιερόδουλες της Τεχεράνης είναι 2·247=494.

Για να υπολογιστεί το εν λόγω ποσοστό έγινε μία ακόμα δειγματοληψία 8 μέρες μετά. Εκεί δόθηκαν βραχιολάκια σε 190 ιερόδουλες και τους έγιναν κάποιες ερωτήσεις, μεταξύ των οποίων και αν έλαβαν μπλουζάκι από την προηγούμενη έρευνα. 68 εξ αυτών απάντησαν πως είχαν λάβει, οπότε συμπεραίνουμε πως η συγκεκριμένη δειγματική αναλογία:

\dfrac{\iota\varepsilon\rho o\delta o\upsilon\lambda\varepsilon\varsigma \ \ \mu\varepsilon \ \ \mu\pi\lambda o \upsilon\zeta\alpha\kappa\iota}{\sigma\upsilon\nu o \lambda o \ \ \iota\varepsilon\rho o\delta o \upsilon \lambda\omega\nu}

ισούται με:

\dfrac{68}{190}=0.3578947

Θα θέλαμε βάσει αυτής να κάνουμε μια εκτίμηση της πληθυσμιακής αναλογίας (άρα και του πραγματικού πλήθους των εκπορνευομένων γυναικών), για την οποία να είμαστε σίγουροι κατά 98%. Η πληθυσμιακή αναλογία, καθόσον ερευνήσαμε μεγάλο πλήθος ιερόδουλων (>30), περιμένουμε ότι θα είναι κοντά στην δειγματική. Πάμε όμως να δούμε πόσο κοντά θα είναι με σιγουριά 98%, αφού όμως διαγράψουμε τις προηγούμενες μεταβλητές:

```{r}
rm(list = ls())
```

Η δουλειά που θέλαμε θα γίνει μέσω μιας συνάρτησης που θα φτιάξουμε, της `DiastEmpistPos(🍺🍺🍺,👨👨👨,🎲🎲🎲)`.

-   Στη θέση του `🍺🍺🍺` γράφουμε το ποσοστό του δείγματος που βρήκαμε (εδώ το 0.3578947),

-   στη θέση του `👨👨👨` θα πάει το πλήθος των τιμών (δηλαδή οι 190 ιερόδουλες) και

-   στη θέση του `🎲🎲🎲` θα πάει η σιγουριά που θέλουμε να έχουμε (εν προκειμένω θέλουμε να είμαστε σίγουροι κατά 98%=0.98).

Η συνάρτησή μας είναι λοιπόν η:

```{r}
DiastEmpistPos <- function(pososto, plithos, pith) {
  s <- sqrt(pososto*(1-pososto)/plithos)
  a <- (1-pith)/2
  t <- qt(a, plithos-1, lower.tail=F)
  m1 <- pososto-t*s
  m2 <- pososto+t*s
  c(m1, m2)
}
```

Οπότε γράφουμε:

```{r}
DiastEmpistPos(0.3578947, 190, 0.98)
```

Εξάγεται έτσι η διπλανή απάντηση, όπερ σημαίνει ότι μπορούμε να είμαστε σίγουροι κατά 98% ότι η (πληθυσμιακή) αναλογία των ιερόδουλων με μπλουζάκι στο σύνολο των ιερόδουλων της Τεχεράνης θα είναι ανάμεσα στις τιμές `r DiastEmpistPos(0.3578947, 190, 0.98)[1]` και `r DiastEmpistPos(0.3578947, 190, 0.98)[2]`.

Όμως μπλουζάκι πήραν 247 ιερόδουλες. Έτσι, αν αυτές είναι το 27-43% όλων των ιερόδουλων, τότε όλες οι ιερόδουλες της Τεχεράνης θα είναι ανάμεσα στις τιμές:

$\dfrac{247}{0.2762973}\approx 562$   και $\dfrac{247}{0.4394921}\approx 894$.

Δηλαδή οι ιερόδουλες της Τεχεράνης είναι από 562 έως 894 με 98% σιγουριά.

Συνολικά γράψαμε τον κώδικα:

```{r, eval=F}
rm(list = ls())
DiastEmpistPos <- function(pososto, plithos, pith) {
  s <- sqrt(pososto*(1-pososto)/plithos)
  a <- (1-pith)/2
  t <- qt(a, plithos-1, lower.tail=F)
  m1 <- pososto-t*s
  m2 <- pososto+t*s
  c(m1, m2)
}
DiastEmpistPos(0.3578947,190,0.98)
```


