---
title: "Ανάλυση Αντιστοιχίας"
author: "Κώστας Κούδας"
cache: TRUE
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    fig_caption: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
```


# Παρουσίαση δεδομένων


```{r, echo=FALSE}
rm(list = ls())
```

Στην παρούσα ενότητα θα εξετάσουμε την πρόθεση ψήφου διαφόρων ανθρώπων σε συνδυασμό με το πού κατατάσσουν τον εαυτό τους πολιτικά. Αντλήσαμε δεδομένα από το [Ινστιτούτο Εναλλακτικών Ιδεών και Πολιτικών - Ένα](https://enainstitute.org/wp-content/uploads/2024/02/%CE%88%CF%81%CE%B5%CF%85%CE%BD%CE%B1_%CE%95%CE%9D%CE%91_Final.pdf) και με αυτά φτιάξαμε τον πίνακα δεδομένων `prothesiPsifoy`. Η διαδικασία καταχώρησης [θεωρείται γνωστή](pinakes.html) και δεν αναλύεται παραπάνω.


```{r}
# Δημιουρία στηλών

politiki_taytotita <- c(
  "Πατριώτης", "Κεντρώος", "Προοδευτικός", "Κεντροδεξιός",
  "Κεντροαριστερός", "Φιλελεύθερος", "Οικολόγος", "Αριστερός",
  "Φεμινιστής", "Σοσιαλδημοκράτης", "Υπέρμαχος_ελεύθερης_αγοράς",
  "Δεξιός", "Συντηρητικός", "Σοσιαλιστής", "Εθνικιστής",
  "Αντικαπιταλιστής", "Κομμουνιστής", "Αναρχικός",
  "Ακροδεξιός", "Ακροαριστερός", "Λαϊκιστής", "ΔΞ/ΔΑ"
)

synolo <- c(
  23, 20, 20, 18, 17, 15, 11, 10, 8, 8, 8, 8, 7, 6, 5, 4, 4, 2, 1, 1, 1, 6
)

ilikia17_34 <- c(
  28, 19, 30, 16, 19, 26, 15, 15, 16, 11, 14, 12, 16, 10, 9, 9, 4, 3, 2, 2, 2, 5
)

ilikia35_54 <- c(
  27, 19, 22, 17, 14, 15, 10, 8, 8, 9, 9, 9, 7, 4, 7, 3, 4, 2, 2, 1, 1, 8
)

ilikia55ano <- c(
  17, 22, 15, 19, 19, 10, 10, 10, 6, 6, 5, 5, 3, 5, 3, 3, 4, 1, 0, 1, 0, 4
)

ND <- c(
  20, 29, 19, 43, 4, 28, 9, 0, 6, 4, 15, 11, 6, 1, 0, 0, 0, 0, 0, 0, 0, 3
)

SYRIZA <- c(
  9, 14, 34, 3, 49, 4, 11, 29, 11, 7, 2, 1, 1, 11, 1, 6, 2, 2, 0, 1, 1, 3
)

PASOK <- c(
  13, 39, 25, 7, 43, 11, 14, 4, 9, 30, 6, 1, 2, 14, 0, 1, 0, 1, 0, 0, 1, 2
)

KKE <- c(
  12, 10, 18, 2, 11, 8, 9, 32, 9, 3, 0, 0, 4, 12, 1, 16, 40, 5, 0, 4, 2, 5
)

Spartiates <- c(
  54, 8, 8, 8, 0, 12, 19, 0, 0, 4, 8, 19, 0, 0, 46, 4, 0, 0, 15, 0, 8, 0
)

Elliniki_Lysi <- c(
  52, 8, 9, 19, 3, 9, 1, 1, 0, 0, 7, 15, 18, 1, 18, 0, 0, 0, 3, 0, 2, 4
)

Niki <- c(
  71, 12, 8, 17, 3, 7, 5, 0, 5, 3, 7, 27, 29, 2, 15, 7, 0, 0, 2, 0, 0, 3
)

Pleysi_Eleytherias <- c(
  29, 19, 35, 3, 23, 10, 19, 10, 26, 13, 0, 6, 3, 3, 6, 6, 3, 3, 0, 0, 0, 16
)

Nea_Aristera <- c(
  4, 4, 27, 2, 37, 4, 27, 57, 24, 16, 0, 0, 2, 22, 0, 14, 0, 6, 0, 6, 0, 2
)

MERA25 <- c(
  12, 5, 29, 2, 24, 7, 22, 37, 29, 12, 0, 2, 0, 15, 0, 22, 12, 5, 0, 10, 0, 7
)

Aristera_Kentroaristera <- c(
  10, 6, 30, 0, 48, 5, 16, 31, 16, 15, 2, 0, 0, 15, 0, 11, 11, 5, 0, 3, 1, 1
)

# Δημιουργία του dataframe
prothesiPsifoy <- data.frame(
  politiki_taytotita,
  synolo,
  ilikia17_34,
  ilikia35_54,
  ilikia55ano,
  ND,
  SYRIZA,
  PASOK,
  KKE,
  Spartiates,
  Elliniki_Lysi,
  Niki,
  Pleysi_Eleytherias,
  Nea_Aristera,
  MERA25,
  Aristera_Kentroaristera
)


```

Ας δούμε κι αυτό που φτιάξαμε:

```{r echo = F, results='asis', message=FALSE}
knitr::kable(prothesiPsifoy) %>%
  kable_styling("striped", full_width = F) %>%
  scroll_box(width = "100%", height = "200px")
```

Βλέπουμε ότι κάθε γραμμή αντιστοιχεί σε κάποια πολιτική ταυτότητα. Στόχος μας θα είναι να εξετάσουμε αν υπάρχουν κάποια πρότιμα επιλογής, κάποια μοτίβα στους ψηφοφόρους. Έτσι, στην προκειμένη περίπτωση, εκτός από αισθητικά ωραίο, είναι και πρακτικά (για τη μελέτη μας) αναγκαίο οι γραμμές να έχουν τα ονόματα των αντίστοιχων πολιτικών ταυτοτήτων, αντί να είναι απλά αριθμημένες σε αύξουσα σειρά. 


Αυτό θα το πετύχουμε μέσω της συνάρτησης `rownames()`. Αν έχουμε μια λίστα με λέξεις `💌💌💌`, τότε γράφοντας `rownames(💌💌💌)`, οι γραμμές μας αποκτάνε τα ονόματα που αναφέρει η λίστα `💌💌💌`. 

Έτσι γράφουμε:

```{r}
rownames(prothesiPsifoy) <- prothesiPsifoy$politiki_taytotita
```

Κι έχουμε πλέον τον κάτωθι πίνακα δεδομένων:


```{r echo = F, results='asis', message=FALSE}
knitr::kable(prothesiPsifoy) %>%
  kable_styling("striped", full_width = F) %>%
  scroll_box(width = "100%", height = "200px")
```

Προφανώς, πλέον η στήλη `politiki_taytotita` δεν μας χρειάζεται, επομένως θα την αποσύρουμε από τον πίνακα. Μαζί θα αποσύρουμε και τις στήλες `synolo`, `Aristera_Kentroaristera`, `ilikia17_34`, `ilikia35_54` και `ilikia55ano`, που δεν τις θέλουμε στην ανάλυσή μας. Γράφουμε λοιπόν:

```{r}
prothesiPsifoy <- prothesiPsifoy[, !colnames(prothesiPsifoy) %in% c("politiki_taytotita", "synolo", "Aristera_Kentroaristera", "ilikia17_34", "ilikia35_54", "ilikia55ano")]
```

Έτσι, έχουμε:

```{r echo = F, results='asis', message=FALSE}
knitr::kable(prothesiPsifoy) %>%
  kable_styling("striped", full_width = F) %>%
  scroll_box(width = "100%", height = "200px")
```

# Γράφημα διπλής προβολής


Τώρα που ο πίνακας δεδομένων ήρθε στη μορφή που θέλαμε, πάμε να εγκαταστήσουμε τα πακέτα που θα κάνουν τη δουλειά που θέλουμε. Πριν, όμως, θα επισημάνουμε ένα πρόβλημα, το οποίο για διδακτικούς λόγους θα αγνοήσουμε εδώ:

- Τα στοιχεία της κάθε στήλης δεν είναι ποσοστά επί του συνόλου ή απόλυτες συχνότητες. Είναι ποσοστά επί των ψηφοφόρων του αντίστοιχου κόμματος.

Εν πάση περιπτώσει, είπαμε ότι θα το αγνωήσουμε, οπότε πάμε στα πακέτα μας. Αυτά είναι τα `FactoMineR` και `factoextra`. Γράφουμε, λοιπόν, τα παρακάτω.

```{r}
if(!require(FactoMineR)){
    install.packages("FactoMineR")
    library(FactoMineR)
}
if(!require(factoextra)){
    install.packages("factoextra")
    library(factoextra)
}
```

Ο πυρήνας της δουλειάς μας είναι τα αποτελέσματα της συνάρτησης `CA()`. Έχοντας έναν πίνακα δεδομένων `💻💻💻`, σαν τον `prothesiPsifoy` και γράφοντας `CA(💻💻💻)`, εξάγεται το παρακάτω γράφημα, το οποίο αποκαλούμε **γράφημα διπλής προβολής**, και κάποια αποτελέσματα που αυτή τη στιγμή δεν φαίνονται και δεν θα μας απασχολήσουν παραπάνω. Τα εν λόγω αποτελέσματα τα αποθηκεύουμε με το όνομα `apotelesmataCORA`, ώστε να τα χρησιμοποιήσουμε και μετά.

```{r}
apotelesmataCORA <- CA(prothesiPsifoy)
```

Πριν εμβαθύνουμε στο διάγραμμά μας, να πούμε ότι μπορούμε να το σχεδιάσουμε και χρησιμοποιώντας τη συνάρτηση `fviz_ca_biplot()` ως ακολούθως:

```{r}
fviz_ca_biplot(apotelesmataCORA,
               repel = TRUE, # Αποτρέπει την επικάλυψη ετικετών
               col.row = "purple", # Χρώμα για τις γραμμές (πολιτικές ταυτότητες)
               col.col = "orange",  # Χρώμα για τις στήλες (κόμματα)
               title = "Γράφημα Διπλής Προβολής πολιτικών κομμάτων και ταυτοτήτων"
               )
```



Για να ερμηνεύσουμε τι σημαίνει η θέση σε αυτό το σύστημα συντεταγμένων, θα πρέπει να νοηματοδοτήσουμε τις αποστάσεις σε αυτό. Το «ζουμί» είναι στις σχέσεις μεταξύ των διαφορετικών χρωμάτων. Αυτό που εξετάζουμε όταν κοιτάζουμε δύο διαφορετικά χρώματα (κόμμα με πολιτική ταυτότητα εν προκειμένω) είναι με τι γωνία βλέπει το ένα και το άλλο ένας παρατηρητής που είναι στημένος στην αρχή των αξόνων (έστω Ο), εκεί που διασταυρώνεται ο οριζόντιος με τον κατακόρυφο άξονα. 

Ας το δούμε λίγο πιο συγκεκριμένα!

- Για παράδειγμα η γωνία που σχηματίζουν οι γραμμές Ο-`ND` και Ο-`κεντροδεξιός` είναι πολύ μιτερή ($<90^\circ$) και με μεγάλες πλευρές. Αυτό δηλώνει θετική συσχέτιση (έλξη). Δηλαδή το ότι μιλάμε για κόμμα ΝΔ, σημαίνει ότι το ποσοστό των κεντροδεξιών αναπηδά απότομα προς τα πάνω. Αλλά και ανάποδα! Αν εξετάσουμε τους κεντροδεξιούς, τα ποσοστά της ΝΔ έχουν εμφανή διαφορά προς τα πάνω από το μέσο ποσοστό των κομμάτων. 

- Αντίθετα, η γωνία που σχηματίζουν οι γραμμές Ο-`SYRIZA` και Ο-`εθνικιστής` είναι πολύ ίσια ($\approx 180^\circ$) και με μεγάλες πλευρές. Αυτό δηλώνει αρνητική συσχέτιση (άπωση). Δηλαδή στους ψηφοφόρους του ΣΥΡΙΖΑ το να είσαι εθνικιστής είναι εμφανώς κάτω του μέσου όρου των πολιτικών ταυτοτήτων. Αντίστροφα αν το δούμε, εστιάζοντας στους εθνικιστές, οι συριζέοι έχουν μια έντονη προς τα κάτω απόκλιση από αυτό που θα αναμέναμε (μέση τιμή κομμάτων).

- Έχουμε, όμως, και τις ενδιάμεσες γωνίες, αυτές των $\approx 90^\circ$. Π.χ.  οι γραμμές Ο-`PASOK` και Ο-`φιλελεύθερος` είναι σχεδόν κάθετες. Αυτό δξηλώνει ότι δεν έχουν καμία συσχέτιση. Η πολιτική ταυτότητα «φιλελεύθερος» εμφανίζεται στο κόμμα με τη συχνότητα του μέσου όρου.

- Τέλος, στην περίπτωση που έχουμε μικρές πλευρές, δηλαδή μικρή απόσταση από το Ο, μιλάμε για κόμμα ή πολιτική ταυτότητα που δεν ξεχωρίζει από το μέσο όρο. Δηλαδή οι ΔΞ/ΔΑ είναι κοντά στον μέσο όρο για κάθε κόμμα. Π.χ. κοιτάζοντας το ΚΚΕ, αυτοί που δηλώνουν ότι δεν έχουν κάποια πολιτική ταυτότητα δεν έχουν να επιδείξουν κάποια έντονη ποσοστική διαφορά προς τα πάνω ή προς τα κάτω σε σχέση με τη μέση τιμή όλων των πολιτικών ταυτοτήτων.

Τι σημαίνουν τα παραπάνω για την περίπτωση που μελετάμε το ιδιο χρώμα (κόμμα με κόμμα ή ταυτότητα με ταυτότητα); Ας πάρουμε, για παράδειγμα, τις πολιτικές ταυτότητες «εθνικιστής» και «ακροδεξιός». Αυτές απέγουν πολύ σχεδόν το ίδιο από το κέντρο Ο και προς την ίδια κατεύθυνση. Αυτό σημαίνει ότι στην περίπτωση που υφίσταται μία εξ αυτών, τότε επηρρεάζουν εξίσου (θετικά, αρνητικά ή καθόλου) τις πιθανότητες εμφάνισης του εκάστοτε κόμματος. Αλλά και αντίστροφα! Εστιάζοντας σε ένα οποιοδήποτε κόμμα (π.χ. ΣΥΡΙΖΑ) η πολιτική ταυτότητα «εθνικιστής» έχει παρόμοια κατάταξη (πάνω ή κάτω από τον μέσο όρο όλων των πολιτικών ταυτοτήτων) με την πολιτική ταυτότητα «ακροδεξιός».

Κλείνοντας αυτή την ενότητα μπορούμε να πούμε πως οι δύο άξονες έρχονται για να ποσοτικοποιήσουν τις ζώνες επιρροής. Εν προκειμένω παρουσιάζουμε δύο ποιοτικά διαφορετικά συστήματα ζωνών επιρροής, αυτό που προσδιορίζεται από τον οριζόντιο άξονα κι αυτό από τον κατακόρυφο. Κάθε σημείο του επιπέδου είναι απλά μια ποσοτική έκφραση αυτών των δύο. Ας το δούμε και λίγο καλύτερα:

- Καταρχάς, βλέπουμε δύο σχεδόν κατακόρυφες στήλες, η μία που περιέχει τα κόμματα της αριστεράς, η άλλη της δεξιάς. Αυτό που συμπεραίνουμε έιναι ότι ο οριζόντιος άξονας κατηγοριοποιεί τα κόμματα και τις πολιτικές ταυτότητες βάσει απλά του σχήματος αριστερά-δεξιά. Για παράδειγμα το ΚΚΕ φαίνεται να ανήκει στο ακραίο τμήμα της αριστεράς, η ΝΔ στο ακραίο σημείο της δεξιάς, ενώ η Πλεύση Ελευθερίας σε κάτι ενδιάμεσο, σε κάτι πιο κοντά στο μέσο όρο όλων.

- Ο κατακόρυφος άξονας που είδαμε ότι χωρίζει σε δύο αντιδιαμετρικά μέρη τα κόμματα, ο ίδιος χωρίζει και τις πολιτικές ταυτότητες. Πολιτικές ταυτότητες που έχουν να κάνουν με την αριστερά (λίγο-πολύ) είναι στα αριστερά και με την δεξιά (λίγο-πολύ) είναι στα δεξιά. Αυτός είναι ένας ακόμα λόγος που μάς κάνει να πιστεύουμε πως ο οριζόντιος άξονας είναι το φάσμα αριστερά-δεξιά με τις αποχρώσεις του.

- Ο οριζόντιος άξονας με τη σειρά του φαίνεται να χωρίζει τα κόμματα, όπως και τις πολιτικές ταυτότητες σε ένα συστημικο μέρος (το άνω μέρος) κι ένα ανατρεπτικό (το κάτω μέρος). Συνεπώς, τα κόμματα και οι πολιτικές ταυτότητες που είναι ακριβώς πάνω (ή εκεί κοντά) στην οριζόντια διαχωριστική γραμμή είναι γύρω στο μέσο όρο, είναι αυτά που δεν διακρίνονται για τις ανατρεπτικές ή συστημικές απόψεις τους.

Πόσο καλά καταγοριοποιούνται κόμματα και πολιτικές ταυτότητες από δύο μόνο άξονες; Ας μην ξεχνάμε πως είχαμε `r length(colnames(prothesiPsifoy))` κόμματα και  `r length(prothesiPsifoy$KKE)` πολιτικές ταυτότητες, ήτοι `r length(prothesiPsifoy$KKE)*length(colnames(prothesiPsifoy))` πιθανούς πολιτικούς χαρακτηρισμούς. Αυτό έρχονται να μας το αποκαλύψουν τα ποσοστά που αναγράφονται στους άξονες. Το γράφημα διπλής προβολής μάς λέει ότι η μία διάσταση (`Dim 1`) αρκεί για να εξηγήσει το 48.66% των δεδομένων μας. Η επιπλέον διάσταση (`Dim 2`) είναι για να εξηγήσει το επιπλέον 17,90%. Συνολικά εξηγούν το 66.56% των δεδομένων μας.

Αν στον αναγνώστη το 66.56% φαντάζει φτωχό, μπορεί να προσθέσει καινούριες διαστάσεις. Το πόσες θα πετύχουν την ακρίβεια που επιθυμεί, θα του το αποκαλύψει η συνάρτηση `fviz_eig()`, η οποία φτιάχνει το λεγόμενο *γράφημα παραγόντων*. Έχοντας `✍️✍️✍️`  τα αποτελέσματα της 1ης ανάλυσης που κάναμε (εδώ έχει όνομα `apotelesmataCORA`) και γράφοντας `fviz_eig(✍️✍️✍️, addlabels = TRUE)`, βλέπουμε πόση πληροφορία προσθέτει η κάθε επιπλέον διάσταση και προσθέτουμε τόσες, όσες απαιτεί η ακρίβεια που επιθυμούμε.

```{r}
# Scree plot
fviz_eig(apotelesmataCORA, addlabels = TRUE)
```

Έτσι, η τρίτη διάσταση δίνει ένα ακόμα 13.1% πληροφορίας. Συνολικά με τρεις διαστάσεις τα δεδομένα μας περιγράφονται κατά 79.7%, κάτι αρκετά αξιοπρεπές. Γενικώς επιδιώκουμε κάτι παραπάνω από 50-70%, οπότε δεδομένου ότι οι δύο διαστάσεις είναι πολύ βολικότερες από τις τρεις, θα κρατήσουμε την αρχική μας επιλογή, έστω κι αν η ακρίβεια που δίνει είναι 66.56%.

# Αξιολόγηση γραφήματος διπλής προβολής

Ένα θέμα που μπορεί να μας απασχολήσει, είναι το πόσο καλά περιγράφονται τα κόμματα και οι πολιτικές ταυτότητες από τους άξονες. Δεν είναι σε κάθε κόμμα και σε κάθε πολιτική ταυτότητα η ίδια απάντηση. Σε αυτό θα μας βοηθήσουν τα παρακάτω γραφήματα (βλ. `cos2`).

```{r}
fviz_ca_row(apotelesmataCORA, repel = TRUE,
            col.row = "cos2",
            title = "Ποιες πολιτικές ταυτότητες εκπροσωπούνται καλά;"
            )
```

Βλέπουμε, λοιπόν, ότι οι πολιτικές ταυτότητες (βλ. `col.row`) «δεξιός» και «αναρχικός» απεικονίζονται αξιόπιστα, ενώ όχι πολύ καλά οι αναποφάσιστοι (ΔΞ/ΔΑ). Ας δούμε και τα κόμματα (βλ. `col.col`:

```{r}
fviz_ca_col(apotelesmataCORA, repel = TRUE,
            col.col = "cos2",
            title = "Ποια πολιτικά κόμματα εκπροσωπούνται καλά;"
            )
```

Η Πλεύση Ελευθερίας δεν απεικονίζεται καθόλου καλά, ενώ το ΜΕΡΑ25 είναι εντάξει.

# Εμβάθυνση στην ερμηνεία του γραφήματος διπλής προβολής

Τώρα θα κοιτάξουμε λίγο προσεκτικότερα τους άξονες. Η ερμηνεία τους άπτεται στην φαντασία του ερευνητή, οπότε εδώ θα την υποβοηθήσουμε. Ποιες πολιτικές ταυτότητες συνείσφεραν περισσότερο στον σχηματισμό των αξόνων; Σε αυτό θα μάς βοηθήσουν τα παρακάτω γραφήματα (βλ. `contrib`).

```{r}
fviz_ca_row(apotelesmataCORA, repel = TRUE,
            col.row = "contrib",
            title = "Συνεισφορά πολιτικών ταυτοτήτων στη διαμόρφωση των αξόνων"
            )
```

Στη διαμόρφωση των αξόνων βλέπουμε ότι συνείσφεραν περισσότερο οι πολιτικές ταυτότητες (βλ. `col.row`) «πατριώτης» και «αριστερός», παρά η πολιτική ταυτότητα «φεμινιστής». Ας δούμε και κάτι αντίστοιχο για τα κόμματα (βλ. `col.col`)

```{r}
fviz_ca_col(apotelesmataCORA, repel = TRUE,
            col.col = "contrib",
            title = "Συνεισφορά κομμάτων στη διαμόρφωση των αξόνων"
            )
```

Βλέπουμε ότι στη διαμόρφωση των αξόνων συνείσφεραν περισσότερο οι Σπαρτιάτες, παρά η ΝΔ. Αυτό, ίσως, καταδεικνύει την ανεπάρκεια των αρχικών μας δεδομένων, την οποία και επισημάναμε αρχικά.

Συνολικά ο κώδικας έχει ως εξής.

```{r, eval=FALSE}
# Δημιουρία στηλών

politiki_taytotita <- c(
  "Πατριώτης", "Κεντρώος", "Προοδευτικός", "Κεντροδεξιός",
  "Κεντροαριστερός", "Φιλελεύθερος", "Οικολόγος", "Αριστερός",
  "Φεμινιστής", "Σοσιαλδημοκράτης", "Υπέρμαχος_ελεύθερης_αγοράς",
  "Δεξιός", "Συντηρητικός", "Σοσιαλιστής", "Εθνικιστής",
  "Αντικαπιταλιστής", "Κομμουνιστής", "Αναρχικός",
  "Ακροδεξιός", "Ακροαριστερός", "Λαϊκιστής", "ΔΞ/ΔΑ"
)

synolo <- c(
  23, 20, 20, 18, 17, 15, 11, 10, 8, 8, 8, 8, 7, 6, 5, 4, 4, 2, 1, 1, 1, 6
)

ilikia17_34 <- c(
  28, 19, 30, 16, 19, 26, 15, 15, 16, 11, 14, 12, 16, 10, 9, 9, 4, 3, 2, 2, 2, 5
)

ilikia35_54 <- c(
  27, 19, 22, 17, 14, 15, 10, 8, 8, 9, 9, 9, 7, 4, 7, 3, 4, 2, 2, 1, 1, 8
)

ilikia55ano <- c(
  17, 22, 15, 19, 19, 10, 10, 10, 6, 6, 5, 5, 3, 5, 3, 3, 4, 1, 0, 1, 0, 4
)

ND <- c(
  20, 29, 19, 43, 4, 28, 9, 0, 6, 4, 15, 11, 6, 1, 0, 0, 0, 0, 0, 0, 0, 3
)

SYRIZA <- c(
  9, 14, 34, 3, 49, 4, 11, 29, 11, 7, 2, 1, 1, 11, 1, 6, 2, 2, 0, 1, 1, 3
)

PASOK <- c(
  13, 39, 25, 7, 43, 11, 14, 4, 9, 30, 6, 1, 2, 14, 0, 1, 0, 1, 0, 0, 1, 2
)

KKE <- c(
  12, 10, 18, 2, 11, 8, 9, 32, 9, 3, 0, 0, 4, 12, 1, 16, 40, 5, 0, 4, 2, 5
)

Spartiates <- c(
  54, 8, 8, 8, 0, 12, 19, 0, 0, 4, 8, 19, 0, 0, 46, 4, 0, 0, 15, 0, 8, 0
)

Elliniki_Lysi <- c(
  52, 8, 9, 19, 3, 9, 1, 1, 0, 0, 7, 15, 18, 1, 18, 0, 0, 0, 3, 0, 2, 4
)

Niki <- c(
  71, 12, 8, 17, 3, 7, 5, 0, 5, 3, 7, 27, 29, 2, 15, 7, 0, 0, 2, 0, 0, 3
)

Pleysi_Eleytherias <- c(
  29, 19, 35, 3, 23, 10, 19, 10, 26, 13, 0, 6, 3, 3, 6, 6, 3, 3, 0, 0, 0, 16
)

Nea_Aristera <- c(
  4, 4, 27, 2, 37, 4, 27, 57, 24, 16, 0, 0, 2, 22, 0, 14, 0, 6, 0, 6, 0, 2
)

MERA25 <- c(
  12, 5, 29, 2, 24, 7, 22, 37, 29, 12, 0, 2, 0, 15, 0, 22, 12, 5, 0, 10, 0, 7
)

Aristera_Kentroaristera <- c(
  10, 6, 30, 0, 48, 5, 16, 31, 16, 15, 2, 0, 0, 15, 0, 11, 11, 5, 0, 3, 1, 1
)

# Δημιουργία του dataframe
prothesiPsifoy <- data.frame(
  politiki_taytotita,
  synolo,
  ilikia17_34,
  ilikia35_54,
  ilikia55ano,
  ND,
  SYRIZA,
  PASOK,
  KKE,
  Spartiates,
  Elliniki_Lysi,
  Niki,
  Pleysi_Eleytherias,
  Nea_Aristera,
  MERA25,
  Aristera_Kentroaristera
)

rownames(prothesiPsifoy) <- prothesiPsifoy$politiki_taytotita

prothesiPsifoy <- prothesiPsifoy[, !colnames(prothesiPsifoy) %in% c("politiki_taytotita", "synolo", "Aristera_Kentroaristera", "ilikia17_34", "ilikia35_54", "ilikia55ano")]

if(!require(FactoMineR)){
    install.packages("FactoMineR")
    library(FactoMineR)
}
if(!require(factoextra)){
    install.packages("factoextra")
    library(factoextra)
}

apotelesmataCORA <- CA(prothesiPsifoy)


fviz_ca_biplot(apotelesmataCORA,
               repel = TRUE, # Αποτρέπει την επικάλυψη ετικετών
               col.row = "purple", # Χρώμα για τις γραμμές (πολιτικές ταυτότητες)
               col.col = "orange",  # Χρώμα για τις στήλες (κόμματα)
               title = "Γράφημα Διπλής Προβολής πολιτικών κομμάτων και ταυτοτήτων"
               )

fviz_eig(apotelesmataCORA, addlabels = TRUE)


fviz_ca_row(apotelesmataCORA, repel = TRUE,
            col.row = "cos2",
            title = "Ποιες πολιτικές ταυτότητες εκπροσωπούνται καλά;"
            )

fviz_ca_col(apotelesmataCORA, repel = TRUE,
            col.col = "cos2",
            title = "Ποια πολιτικά κόμματα εκπροσωπούνται καλά;"
            )

fviz_ca_row(apotelesmataCORA, repel = TRUE,
            col.row = "contrib",
            title = "Συνεισφορά πολιτικών ταυτοτήτων στη διαμόρφωση των αξόνων"
            )

fviz_ca_col(apotelesmataCORA, repel = TRUE,
            col.col = "contrib",
            title = "Συνεισφορά κομμάτων στη διαμόρφωση των αξόνων"
            )

```
