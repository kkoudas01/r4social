---
title: "Εκτίμηση μέσης τιμής"
author: "Κώστας Κούδας"
cache: TRUE
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    fig_caption: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
```

# Επίπεδο εμπιστοσύνης

Ας πάρουμε τώρα τις βαθμολογίες των φοιτητών του ΕΜΠ στο μάθημα Θεωρία Πιθανοτήτων και Στατιστική κατά την εξεταστική του Φεβρουαρίου του 2013 που αναφέραμε στην ενότητα [Συχνότητες](syxnotites.html), αφού πρώτα διαγράψαμε ό,τι είχαμε εισάγει μέχρι τώρα στην R:

```{r}
rm(list = ls())
```

```{r echo = F, results='asis', message=FALSE}
if(!require(readxl)){
    install.packages("readxl")
    library(readxl)
}
bathmoi <- readxl::read_excel("bathmoi.xlsx")
knitr::kable(bathmoi) %>%
  kable_styling("striped", full_width = F) %>%
  scroll_box(width = "100%", height = "200px")
```

Αρχικά, όπως και τότε, κρατάμε από τον πίνακα τις βαθμολογίες και απορρίπτουμε τους Αριθμούς Μητρώου και τα `NA`:

```{r}
bathmoi_synolo <- c(bathmoi$BATHMOS...2,
                    bathmoi$BATHMOS...4,
                    bathmoi$BATHMOS...6,
                    bathmoi$BATHMOS...8,
                    bathmoi$BATHMOS...10,
                    bathmoi$BATHMOS...12)
bathmoi_synolo <- na.omit(bathmoi_synolo)
```

Ακολούθως, η μέση τιμή αυτού του δείγματος θα υπολογιστεί γράφοντας:

```{r}
mean(bathmoi_synolo)
```

Βρίσκουμε ότι αυτή είναι `r mean(bathmoi_synolo)`. Θα είχε ενδιαφέρον να γνωρίζουμε τη μέση τιμή των βαθμολογιών στο μάθημα αυτό σε περισσότερες εξεταστικές, πχ σε βάθος δεκαετίας. Δηλαδή πλέον η μέση τιμή `r mean(bathmoi_synolo)` είναι δειγματική μέση τιμή και ψάχνουμε την πληθυσμιακή μέση τιμή όλων των εξεταστικών της δεκαετίας. Θα προσπαθήσουμε να εκτιμήσουμε την πληθυσμιακή μέση τιμή, οπότε θέλουμε να βρούμε πόσο σίγουροι μπορούμε να είμαστε για το ότι αυτή θα απέχει το πολύ π.χ. μισή μονάδα από την δειγματική μέση τιμή που βρήκαμε.

Προς τούτο θα χρειαστούμε την τυπική απόκλιση του δείγματος των βαθμολογών. Λογικό αυτό, καθόσον αυτή μάς δείχνει πόσο απλωμένες είναι οι βαθμολογίες ή, με άλλα λόγια, πόσο συγκεντρωμένες είναι αυτές γύρω από τη μέση τιμή.

```{r}
sd(bathmoi_synolo)
```

Οπότε βρίσκουμε `r sd(bathmoi_synolo)`. Πάμε τώρα να βρούμε πόσο πιθανό είναι να απέχει η πληθυσμιακή μέση τιμή από την `r sd(bathmoi_synolo)` το πολύ 0.5. Γι’ αυτό το σκοπό θα φτιάξουμε μια συνάρτηση που κάνει αυτή τη δουλειά. Η συνάρτηση αυτή θα ονοματιστεί:
`EpipEmpist(💞💞💞, 👨👨👨, 🚂🚂🚂)`.

-   Στη θέση του `💞💞💞` γράφουμε την τυπική απόκλιση που βρήκαμε,

-   στη θέση του `👨👨👨` γράφουμε το πλήθος των τιμών (των βαθμών, δηλαδή, εν προκειμένω) και

-   στη θέση του `🚂🚂🚂` γράφουμε την απόσταση που θέλουμε να δούμε αν απέχει η πληθυσμιακή μέση τιμή από τη δειγματική (εδώ αυτή, όπως είπαμε, είναι 0,5).

Έχουμε λοιπόν:

```{r}
EpipEmpist <- function(tipiki_apokl, plithos, apost) {
  s <- tipiki_apokl/sqrt(plithos)
  2*pt(apost/s, plithos-1)-1
}
```

Ακολούθως, γράφοντας:

```{r}
length(bathmoi_synolo)
```

βρίσκουμε ότι το πλήθος των βαθμολογιών της εξεταστικής του 2013 είναι `r length(bathmoi_synolo)`. Έτσι με την εντολή:

```{r}
EpipEmpist(2.148323, 379, 0.5)
```

εξάγεται απάντηση `r EpipEmpist(2.148323, 379, 0.5)`. Αυτό σημαίνει ότι μπορούμε να είμαστε 99.99% σίγουροι ότι γενικώς κατά τις εξεταστικές περιόδους η μέση βαθμολογία στο μάθημα Θεωρία Πιθανοτήτων και Στατιστική θα απέχει ±0.5 από τη μέση βαθμολογία του δείγματος, δηλαδή την `r mean(bathmoi_synolo)`.

# Διάστημα εμπιστοσύνης

Θα πάρουμε και πάλι τις βαθμολογίες των φοιτητών του ΕΜΠ στο μάθημα Θεωρία Πιθανοτήτων και Στατιστική κατά την εξεταστική του Φεβρουαρίου του 2013.

Αυτή τη φορά όμως θα το πάρουμε ανάποδα. Ας υποθέσουμε ότι θέλουμε να είμαστε 95% σίγουροι για τη γνωμάτευση που θέλουμε να κάνουμε για τους βαθμούς του εν λόγω μαθήματος σε όλη τη δεκαετία. Ψάχνουμε, λοιπόν, να βρούμε δύο αριθμούς ανάμεσα στους οποίους να είναι κατά 95% πιθανό ότι βρίσκεται η μέση τιμή όλων των βαθμολογιών της δεκαετίας στο μάθημα αυτό.

Βρήκαμε πριν ότι η μέση τιμή είναι `r mean(bathmoi_synolo)` και ότι η τυπική απόκλιση είναι `r sd(bathmoi_synolo)`. Επίσης είπαμε ότι έχουμε `r length(bathmoi_synolo)` βαθμολογίες. Η δουλειά που θέλαμε θα γίνει μέσω μιας συνάρτησης που θα φτιάξουμε, της `DiastEmpist(🔪🔪🔪,💞💞💞,👨👨👨,🎲🎲🎲)`.

-   Στη θέση του `🔪🔪🔪` γράφουμε τη μέση τιμή του δείγματος,

-   στη θέση του `💞💞💞` γράφουμε τη δειγματική τυπική απόκλιση,

-   στη θέση του `👨👨👨` θα πάει το πλήθος των τιμών και

-   στη θέση του `🎲🎲🎲` θα πάει η σιγουριά που θέλουμε να έχουμε.

Η συνάρτησή μας είναι λοιπόν η:

```{r}
DiastEmpist <- function(mesi_timi, tipiki_apokl, plithos, pith) {
  s <- tipiki_apokl/sqrt(plithos)
  a <- (1-pith)/2
  t <- qt(a, plithos-1, lower.tail=F)
  m1 <- mesi_timi-t*s
  m2 <- mesi_timi+t*s
  c(m1, m2)
}
```

Οπότε γράφουμε:

```{r}
DiastEmpist(4.295515, 2.283424, 379, 0.95)
```

Τι σημαίνει η παραπάνω απάντηση; Σημαίνει ότι μπορούμε να είμαστε κατά 95% σίγουροι ότι η μέση τιμή των βαθμολογιών στο μάθημα αυτό σε όλη τη δεκαετία θα είναι μεταξύ των αριθμών `r DiastEmpist(4.295515, 2.283424, 379, 0.95)[1]` και `r DiastEmpist(4.295515, 2.283424, 379, 0.95)[2]`.

Ο κώδικας που χρησιμοποιήσαμε ήταν συνολικά ο κάτωθι:

```{r, eval=F}
rm(list = ls())
bathmoi_synolo <- c(bathmoi$BATHMOS...2,
                    bathmoi$BATHMOS...4,
                    bathmoi$BATHMOS...6,
                    bathmoi$BATHMOS...8,
                    bathmoi$BATHMOS...10,
                    bathmoi$BATHMOS...12)
bathmoi_synolo <- na.omit(bathmoi_synolo)
mean(bathmoi_synolo)
sd(bathmoi_synolo)
EpipEmpist <- function(tipiki_apokl, plithos, apost) {
  s <- tipiki_apokl/sqrt(plithos)
  2*pt(apost/s,plithos-1)-1
}
length(bathmoi_synolo)
EpipEmpist(2.148323, 379, 0.5)
DiastEmpist <- function(mesi_timi, tipiki_apokl, plithos, pith) {
  s <- tipiki_apokl/sqrt(plithos)
  a <- (1-pith)/2
  t <- qt(a, plithos-1, lower.tail=F)
  m1 <- mesi_timi-t*s
  m2 <- mesi_timi+t*s
  c(m1, m2)
}
DiastEmpist(4.295515, 2.283424, 379, 0.95)
```



