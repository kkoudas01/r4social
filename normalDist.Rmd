---
title: "Κανονική κατανομή"
author: "Κώστας Κούδας"
cache: TRUE
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    fig_caption: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
```

```{r, echo=F}
rm(list = ls())
```

<mark>Έστω ότι έχουμε έναν πληθυσμό και παίρνουμε από αυτόν μεγάλα δείγματα συγκεκριμένου μεγέθους (>30) για να μετρήσουμε κάποια μεταβλητή. Οι μέσες τιμές αυτής της μεταβλητής από αυτά τα δείγματα ακολουθούν την **κανονική κατανομή**. Επίσης το άθροισμα των τιμών του κάθε δείγματος ακολουθεί την **κανονική κατανομή**.</mark>

Συγκεκριμένα, αν ξέρουμε την πληθυσμιακή μέση τιμή και την πληθυσμιακή τυπική απόκλιση τότε οι δειγματικές μέσες τιμές ακολουθούν μια πλήρως προσδιορισμένη κανονική κατανομή και τα αθροίσματα μιαν άλλη κανονική κατανομή.

Αλλά ας το δούμε πιο συγκεκριμένα! Υποθέτουμε ότι έχουμε κάποιες μηλιές που παράγουν μήλα με μέσο βάρος 50 γραμμάρια και τυπική απόκλιση 10 γραμμάρια. Παίρνουμε ένα δείγμα 400 μήλων και ψάχνουμε (α’) το μέσο βάρος των μήλων του δείγματος και (β’) το συνολικό βάρος των μήλων του δείγματος. Αυτά τα μεγέθη θ’ ακολουθούν τις κανονικές κατανομές $\mathcal{N}(50,\frac{10}{\sqrt{400}})$ και $\mathcal{N}(50\cdot 10,10\sqrt{400})$ αντίστοιχα.

Για να δούμε καλύτερα πώς συμπεριφέρονται τα μέσα βάρη από τα μήλα, θα πάρουμε 1000 καφάσια με 400 μήλα έκαστο. Οπότε γράφουμε:

```{r}
par( mfrow= c(2,2) )
for (i in 1:4) {
  set.seed(100*i)
  xilia_kafasia <- rnorm(1000, mean = 50, sd = 1/2) 
  hist(xilia_kafasia)
}
```

Αυτό σημαίνει ότι ως επί το πλείστον το μέσο βάρος θα είναι 50±0.5 γραμμάρια, ενώ είναι εντελώς απίθανο να τύχουμε μέσο βάρος πάνω από 51 γραμμάρια σε κάποιο καφάσι με 400 μήλα.

Από την άλλη, για το συνολικό βάρος του καφασιού γράφουμε:

```{r}
par( mfrow= c(2,2) )
for (i in 1:4) {
  set.seed(100*i)
  xilia_kafasia <- rnorm(1000, mean = 500, sd = 200) 
  hist(xilia_kafasia)
}
```

Αυτό σημαίνει ότι από τα 1000 καφάσια που εξετάσαμε, τα περισσότερα έχουν βάρος 500±50 γραμμάρια, ενώ είναι απίθανο να τύχουμε καφάσι με βάρος κάτω από 100 γραμμάρια.

Πώς θα μπορούσαμε να βρούμε κάποιες πιθανότητες με περισσότερη ακρίβεια και χωρίς ιστογράμματα; Ας υποθέσουμε ότι θέλουμε να δούμε ποια είναι η πιθανότητα να τύχουμε καφάσι με μέσο βάρος μήλων 51 με 52 γραμμάρια. Προς τούτο γράφουμε:

```{r}
pnorm(52, mean = 50, sd = 1/2)-pnorm(51, mean = 50, sd = 1/2)
```

Βρίσκουμε 0.02271846, δηλαδή είναι 2.27% πιθανό να τύχουμε καφάσι με τέτοιο μέσο βάρος.

Από την άλλη, για να βρούμε την πιθανότητα ένα καφάσι να ζυγίζει 50-150 γραμμάρια θα γράψουμε:

```{r}
pnorm(150, mean = 500, sd = 200)-pnorm(50, mean = 500, sd = 200)
```

και θα βρούμε 0.02783468, δηλαδή μπορούμε να είμαστε 2.78% σίγουροι ότι θα τύχουμε καφάσι με τέτοιο βάρος.

Συνολικά ο κώδικας που γράψαμε είναι ο:

```{r, eval=F}
par( mfrow= c(2,2) )
for (i in 1:4) {
  set.seed(100*i)
  xilia_kafasia <- rnorm(1000, mean = 50, sd = 1/2) 
  hist(xilia_kafasia)
}
for (i in 1:4) {
  set.seed(100*i)
  xilia_kafasia <- rnorm(1000, mean = 500, sd = 200) 
  hist(xilia_kafasia)
}
pnorm(52, mean = 50, sd = 1/2)-pnorm(51, mean = 50, sd = 1/2)
pnorm(150, mean = 500, sd = 200)-pnorm(50, mean = 500, sd = 200)
```

















